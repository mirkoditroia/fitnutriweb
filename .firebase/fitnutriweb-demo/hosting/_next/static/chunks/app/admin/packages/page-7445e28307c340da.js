(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6642],{3998:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var r=a(95155),s=a(12115),l=a(75889),i=a(2821);let o=(0,s.forwardRef)((e,t)=>{let{className:a,variant:s="primary",size:o="md",fullWidth:c,...n}=e;return(0,r.jsx)("button",{ref:t,className:(0,l.QP)((0,i.$)("btn",{primary:"btn-primary",secondary:"btn-outline",ghost:"hover:bg-[color:var(--muted-bg)]",outline:"btn-outline"}[s],{sm:"px-3 py-1 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[o],c&&"w-full"),a),...n})});o.displayName="Button"},33678:(e,t,a)=>{"use strict";a.d(t,{s:()=>o});var r=a(95155),s=a(12115),l=a(3998),i=a(22663);function o(e){let{folder:t,onUploaded:a,accept:o=".pdf,.doc,.docx,.jpg,.jpeg,.png",maxSize:c=10,children:n}=e,[d,u]=(0,s.useState)(!1),m=(0,s.useId)(),x=(0,s.useRef)(null),g=async e=>{var r;let s=null==(r=e.target.files)?void 0:r[0];if(s){if(s.size>1024*c*1024)return void i.toast.error("File troppo grande. Dimensione massima: ".concat(c,"MB"));u(!0);try{let e=new FormData;e.append("file",s),e.append("folder",t),console.log("[UploadButton] Caricamento file: ".concat(s.name," (").concat(s.size," bytes)"));let r=await fetch("/api/upload",{method:"POST",body:e});if(!r.ok){let e=await r.text();throw console.error("[UploadButton] Upload fallito: ".concat(r.status," - ").concat(e)),Error("Upload fallito: ".concat(r.status))}let l=await r.json();if(l.error)throw console.error("[UploadButton] Errore server:",l.error),Error("Errore server: ".concat(l.error));if(!l.url)throw console.error("[UploadButton] Nessun URL ritornato:",l),Error("Nessun URL ritornato dal server");console.log("[UploadButton] Upload completato: ".concat(l.url)),i.toast.success("File caricato con successo!"),a(l.url)}catch(t){console.error("Upload error:",t);let e=t instanceof Error?t.message:"Errore sconosciuto";i.toast.error("Errore caricamento: ".concat(e))}finally{if(u(!1),e.target)try{e.target.value=""}catch(e){}}}};return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{ref:x,type:"file",accept:o,onChange:g,className:"hidden",id:"upload-".concat(t,"-").concat(m),disabled:d}),(0,r.jsx)(l.$,{type:"button",variant:"outline",disabled:d,className:"cursor-pointer",onClick:()=>{var e;return!d&&(null==(e=x.current)?void 0:e.click())},children:d?"⏳ Caricamento...":n||"\uD83D\uDCC1 Carica File"}),(0,r.jsxs)("span",{className:"text-xs text-foreground/60",children:["Max ",c,"MB"]})]})}},35916:(e,t,a)=>{Promise.resolve().then(a.bind(a,86509))},65142:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var r=a(95155),s=a(12115),l=a(75889);let i=(0,s.forwardRef)((e,t)=>{let{className:a,label:s,error:i,id:o,...c}=e,n=o||c.name||"input";return(0,r.jsxs)("div",{className:"w-full",children:[s&&(0,r.jsx)("label",{htmlFor:n,className:"block text-sm font-medium mb-1 text-foreground",children:s}),(0,r.jsx)("input",{id:n,ref:t,className:(0,l.QP)("w-full rounded-lg border border-foreground/10 bg-background/70 backdrop-blur-sm px-3.5 py-2.5 text-sm text-foreground placeholder:text-foreground/50","focus:outline-none focus:ring-4 focus:ring-[rgba(var(--primary-rgb),0.15)] focus:ring-offset-0",i&&"border-accent",a),"aria-invalid":!!i,"aria-describedby":i?"".concat(n,"-error"):void 0,...c}),i&&(0,r.jsx)("p",{id:"".concat(n,"-error"),className:"mt-1 text-xs text-destructive",children:i})]})});i.displayName="Input"},86509:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(95155),s=a(12115),l=a(99018),i=a(65142),o=a(3998),c=a(22663),n=a(33678);function d(){let[e,t]=(0,s.useState)([]),[a,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(""),[x,g]=(0,s.useState)("list");(0,s.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=await (0,l.G9)();t(e)}catch(e){console.error("Error loading packages:",e),c.toast.error("Errore nel caricamento dei pacchetti")}finally{d(!1)}};if(a)return(0,r.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("div",{className:"text-lg text-gray-600",children:"Caricamento pacchetti..."})})});let p=e.filter(e=>e.title.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase())),b=async a=>{try{let r=await (0,l.Kh)(e[a]);t(e.map((e,t)=>t===a?{...e,id:r}:e)),c.toast.success("Pacchetto salvato con successo!")}catch(e){console.error("Error saving package:",e),c.toast.error("Errore nel salvare il pacchetto")}},f=async a=>{let r=e[a];if(!r.id){t(e.filter((e,t)=>t!==a)),c.toast.success("Pacchetto rimosso");return}if(confirm('Sei sicuro di voler eliminare il pacchetto "'.concat(r.title,'"? Questa azione non pu\xf2 essere annullata.')))try{await (0,l.s2)(r.id),t(e.filter((e,t)=>t!==a)),c.toast.success("Pacchetto eliminato con successo")}catch(e){console.error("Errore nell'eliminazione:",e),c.toast.error("Errore nell'eliminazione del pacchetto")}},v=(a,r,s)=>{t(e.map((e,t)=>t===a?{...e,[r]:s}:e))},j=(a,r,s)=>{t(e.map((e,t)=>t===a?{...e,details:{...e.details,[r]:s}}:e))},y=(a,r,s)=>{var l,i;let o=e[a],c=o.basePrice||0,n=o.discountedPrice||0;"basePrice"===r?c=s:n=s;let d=(l=c,i=n,l<=0||i>=l?0:Math.round((l-i)/l*100));t(e.map((e,t)=>t===a?{...e,[r]:s,discountPercentage:d}:e))};return(0,r.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestione Pacchetti"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Gestisci i pacchetti e le offerte del tuo servizio"})]}),(0,r.jsx)(o.$,{onClick:()=>{t([{title:"",description:"",price:0,imageUrl:"",isActive:!0,featured:!1,badge:"",isPromotional:!1,hasDiscount:!1,basePrice:0,discountedPrice:0,discountPercentage:0,paymentText:"",details:{duration:"",sessions:0,features:[],includes:[],requirements:[],notes:""}},...e])},className:"bg-green-600 hover:bg-green-700",children:"+ Nuovo Pacchetto"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(i.p,{placeholder:"Cerca per titolo o descrizione...",value:u,onChange:e=>m(e.target.value),className:"w-full"})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(o.$,{variant:"list"===x?"primary":"outline",onClick:()=>g("list"),size:"sm",children:"Lista"}),(0,r.jsx)(o.$,{variant:"grid"===x?"primary":"outline",onClick:()=>g("grid"),size:"sm",children:"Griglia"})]})]}),(0,r.jsx)("div",{className:"space-y-6",children:0===p.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"text-gray-500 text-lg mb-2",children:"Nessun pacchetto trovato"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Prova a modificare i filtri di ricerca o aggiungi un nuovo pacchetto"})]}):p.map((e,t)=>{var a,s,l,c,d,u,m,x,g,h;return(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-white font-bold text-lg",children:e.title.charAt(0).toUpperCase()||"P"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e.title||"Nuovo Pacchetto"}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isActive?"Attivo":"Inattivo"}),e.featured&&(0,r.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"In Evidenza"}),e.isPromotional&&(0,r.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium",children:"Promozionale"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(o.$,{onClick:()=>b(t),variant:"outline",size:"sm",children:"Salva"}),(0,r.jsx)(o.$,{onClick:()=>b(t),size:"sm",children:"Salva e Pubblica"}),(0,r.jsx)(o.$,{onClick:()=>f(t),variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 border-red-300 hover:border-red-400",children:"\uD83D\uDDD1️"})]})]})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informazioni Base"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(i.p,{label:"Titolo *",value:e.title,onChange:e=>v(t,"title",e.target.value),placeholder:"Nome del pacchetto"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrizione *"}),(0,r.jsx)("textarea",{className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:4,value:e.description,onChange:e=>v(t,"description",e.target.value),placeholder:"Descrizione dettagliata del pacchetto..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Immagine"}),(0,r.jsx)(i.p,{value:null!=(l=e.imageUrl)?l:"",onChange:e=>v(t,"imageUrl",e.target.value),placeholder:"URL dell'immagine"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(n.s,{folder:"packages",onUploaded:e=>v(t,"imageUrl",e)})})]}),(0,r.jsx)(i.p,{label:"Badge",value:null!=(c=e.badge)?c:"",onChange:e=>v(t,"badge",e.target.value),placeholder:"es. POPOLARE, NUOVO"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Prezzi"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"discount-".concat(t),checked:!!e.hasDiscount,onChange:e=>v(t,"hasDiscount",e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,r.jsx)("label",{htmlFor:"discount-".concat(t),className:"text-sm font-medium text-gray-700",children:"Attiva sconti"})]}),e.hasDiscount?(0,r.jsxs)("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(i.p,{label:"Prezzo Base (€)",type:"number",value:null!=(d=e.basePrice)?d:0,onChange:e=>y(t,"basePrice",Number(e.target.value))}),(0,r.jsx)(i.p,{label:"Prezzo Scontato (€)",type:"number",value:null!=(u=e.discountedPrice)?u:0,onChange:e=>y(t,"discountedPrice",Number(e.target.value))})]}),(0,r.jsxs)("div",{className:"p-3 bg-white border border-blue-300 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-sm text-blue-600 font-medium",children:"Sconto"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:[null!=(m=e.discountPercentage)?m:0,"%"]})]})]}):(0,r.jsx)(i.p,{label:"Prezzo (€)",type:"number",value:e.price,onChange:e=>v(t,"price",Number(e.target.value))}),(0,r.jsx)(i.p,{label:"Testo Pagamento",value:e.paymentText||"",onChange:e=>v(t,"paymentText",e.target.value),placeholder:"es. pagabile mensilmente, in un'unica soluzione"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Opzioni"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:!!e.isActive,onChange:e=>v(t,"isActive",e.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Attivo"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:!!e.featured,onChange:e=>v(t,"featured",e.target.checked),className:"rounded border-gray-300 text-yellow-600 focus:ring-yellow-500"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"In evidenza"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:!!e.isPromotional,onChange:e=>v(t,"isPromotional",e.target.checked),className:"rounded border-gray-300 text-red-600 focus:ring-red-500"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Promozionale"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Dettagli"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(i.p,{label:"Durata",value:null!=(x=null==(a=e.details)?void 0:a.duration)?x:"",onChange:e=>j(t,"duration",e.target.value),placeholder:"es. 3 mesi, 6 mesi, 1 anno"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note"}),(0,r.jsx)("textarea",{className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 placeholder:text-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,value:null!=(g=null==(s=e.details)?void 0:s.notes)?g:"",onChange:e=>j(t,"notes",e.target.value),placeholder:"Note aggiuntive..."})]})]})]})]})]})})]},null!=(h=e.id)?h:t)})})]})}}},e=>{e.O(0,[9135,3965,8744,2663,4909,576,8441,1255,7358],()=>e(e.s=35916)),_N_E=e.O()}]);