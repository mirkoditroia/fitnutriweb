(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8816],{2063:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>d});var s=l(5155),o=l(2115),i=l(9018),a=l(3998),n=l(2663),r=l(740);function c(e){let{value:t,onChange:l,label:i}=e,[n,r]=(0,o.useState)(!1),[c,d]=(0,o.useState)(9),[u,m]=(0,o.useState)(0);(0,o.useEffect)(()=>{if(t){let[e,l]=t.split(":").map(Number);d(e),m(l)}},[t]);let x=Array.from({length:24},(e,t)=>t),p=Array.from({length:12},(e,t)=>5*t);return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:i}),(0,s.jsxs)("div",{className:"w-full p-2 border border-border rounded bg-white text-black cursor-pointer hover:border-primary/50 transition-colors flex items-center justify-between",onClick:()=>r(!n),children:[(0,s.jsx)("span",{className:t?"text-black":"text-black/70",children:t||"Seleziona orario"}),(0,s.jsx)("span",{className:"text-black/70",children:"\uD83D\uDD50"})]}),n&&(0,s.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-background border border-border rounded-lg shadow-lg z-50 p-4 min-w-[280px]",children:[(0,s.jsx)("div",{className:"text-center mb-4",children:(0,s.jsx)("h4",{className:"font-medium text-black",children:"Seleziona Orario"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-center",children:"Ore"}),(0,s.jsx)("div",{className:"max-h-32 overflow-y-auto border border-border rounded p-2",children:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-1",children:x.map(e=>(0,s.jsx)("button",{onClick:()=>d(e),className:"p-2 text-sm rounded transition-colors ".concat(c===e?"bg-primary text-primary-foreground":"hover:bg-muted"),children:e.toString().padStart(2,"0")},e))})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-center",children:"Minuti"}),(0,s.jsx)("div",{className:"max-h-32 overflow-y-auto border border-border rounded p-2",children:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-1",children:p.map(e=>(0,s.jsx)("button",{onClick:()=>m(e),className:"p-2 text-sm rounded transition-colors ".concat(u===e?"bg-primary text-primary-foreground":"hover:bg-muted"),children:e.toString().padStart(2,"0")},e))})})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(a.$,{onClick:()=>{l("".concat(c.toString().padStart(2,"0"),":").concat(u.toString().padStart(2,"0"))),r(!1)},className:"flex-1",children:"Conferma"}),(0,s.jsx)(a.$,{variant:"outline",onClick:()=>r(!1),className:"flex-1",children:"Annulla"})]}),(0,s.jsx)("div",{className:"fixed inset-0 -z-10",onClick:()=>r(!1)})]})]})}function d(){var e,t,l,d,m,x;let[p,b]=(0,o.useState)(new Date),[g,h]=(0,o.useState)(60),[f,v]=(0,o.useState)("09:00"),[S,j]=(0,o.useState)("18:00"),[N,D]=(0,o.useState)("09:00"),[y,C]=(0,o.useState)("18:00"),[k,w]=(0,o.useState)(10),[z,A]=(0,o.useState)(10),[F,$]=(0,o.useState)(null),[R,E]=(0,o.useState)("online"),[O,G]=(0,o.useState)([]),[I,_]=(0,o.useState)(""),[B,M]=(0,o.useState)(""),[L,T]=(0,o.useState)(!1),[q,P]=(0,o.useState)("normal"),Q=u(p),U=(0,o.useCallback)(async()=>{let e=await (0,i.getAvailabilityByDate)(Q);e?$(e):$({date:Q,onlineSlots:[],inStudioSlots:[],freeConsultationSlots:[],studioSlots:{}})},[Q]);(0,o.useEffect)(()=>{let e=!0;return(async()=>{try{var t,l;let s=await (0,i.getSiteContent)();if(!e)return;let o=null!=(l=null==s?void 0:s.contactAddresses)?l:[];G(o),!I&&(null==(t=o[0])?void 0:t.name)&&_(o[0].name)}catch(e){}})(),()=>{e=!1}},[I]);let Y=async()=>{if(F){var e,t,l,s;await (0,i.upsertAvailabilityForDate)(Q,null!=(t=null!=(e=F.onlineSlots)?e:F.slots)?t:[],F.freeConsultationSlots,null!=(l=F.inStudioSlots)?l:[],null!=(s=F.studioSlots)?s:{}),n.oR.success("Disponibilit\xe0 salvata")}};return(0,o.useEffect)(()=>{U()},[Q,U]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-black pt-4",children:"\uD83D\uDCC5 Gestione Disponibilit\xe0"}),(0,s.jsxs)("div",{className:"bg-card border border-border rounded-lg p-6 mt-4 space-y-6 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,s.jsx)(a.$,{variant:"normal"===q?"primary":"outline",onClick:()=>P("normal"),className:"flex items-center gap-2 px-6 py-3",children:"\uD83D\uDCC5 Slot Normali"}),(0,s.jsx)(a.$,{variant:"promotional"===q?"primary":"outline",onClick:()=>P("promotional"),className:"flex items-center gap-2 px-6 py-3",children:"\uD83C\uDFAF Slot Consultazioni Gratuite"}),"normal"===q&&(0,s.jsxs)("div",{className:"ml-auto flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-sm text-black",children:"Sede:"}),(0,s.jsx)(a.$,{variant:"online"===R?"primary":"outline",onClick:()=>E("online"),className:"px-4 py-2",children:"\uD83C\uDF10 Online"}),(0,s.jsx)(a.$,{variant:"studio"===R?"primary":"outline",onClick:()=>E("studio"),className:"px-4 py-2",children:"\uD83C\uDFE2 In studio"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"\uD83D\uDCC5 Data"}),(0,s.jsx)(r.Ay,{selected:p,onChange:e=>e&&b(e),dateFormat:"dd/MM/yyyy",className:"w-full rounded-md border border-border bg-white px-3 py-2 text-sm text-black placeholder:text-black/70",minDate:new Date})]}),"normal"===q&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c,{label:"\uD83D\uDD50 Inizio",value:f,onChange:v}),(0,s.jsx)(c,{label:"\uD83D\uDD50 Fine",value:S,onChange:j}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"⏱️ Intervallo (min)"}),(0,s.jsx)("input",{type:"number",min:"5",max:"120",step:"5",value:g,onChange:e=>h(Number(e.target.value)),className:"w-full p-2 border border-border rounded bg-white text-black placeholder:text-black/70"}),(0,s.jsx)("p",{className:"text-xs text-black/70 mt-1",children:"Solo multipli di 5"})]}),"studio"===R&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"\uD83C\uDFE2 Sede"}),(0,s.jsx)("select",{value:I,onChange:e=>_(e.target.value),className:"w-full p-2 border border-border rounded bg-white text-black placeholder:text-black/70",children:O.map((e,t)=>(0,s.jsx)("option",{value:e.name,children:e.name},t))})]})]}),"promotional"===q&&(0,s.jsxs)("div",{className:"col-span-3 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsx)(c,{label:"\uD83D\uDD50 Inizio consultazioni gratuite",value:N,onChange:D}),(0,s.jsx)(c,{label:"\uD83D\uDD50 Fine consultazioni gratuite",value:y,onChange:C})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"⏱️ Durata consultazione (minuti)"}),(0,s.jsx)("input",{type:"number",min:"5",max:"60",step:"5",value:k,onChange:e=>w(Number(e.target.value)),className:"w-full p-2 border border-border rounded bg-white text-black placeholder:text-black/70"}),(0,s.jsx)("p",{className:"text-xs text-black/70 mt-1",children:"Solo multipli di 5"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"⏱️ Gap tra consultazioni (minuti)"}),(0,s.jsx)("input",{type:"number",min:"5",max:"30",step:"5",value:z,onChange:e=>A(Number(e.target.value)),className:"w-full p-2 border border-border rounded bg-white text-black placeholder:text-black/70"}),(0,s.jsx)("p",{className:"text-xs text-black/70 mt-1",children:"Solo multipli di 5"})]})]}),(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,s.jsx)("strong",{children:"ℹ️ Informazioni:"})," Gli slot promozionali vengono generati automaticamente con durata di ",k," minuti e gap di ",z," minuti tra le consultazioni, nel range di ore specificato.",(0,s.jsx)("br",{}),(0,s.jsxs)("span",{className:"text-xs mt-2 block",children:[(0,s.jsx)("strong",{children:"Esempio:"})," con durata ",k," min e gap ",z," min, ogni slot sar\xe0 distanziato di ",k+z," minuti."]})]})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-border",children:[(0,s.jsx)(a.$,{onClick:U,variant:"outline",className:"flex items-center gap-2",children:"\uD83D\uDD04 Carica esistenti"}),(0,s.jsxs)(a.$,{onClick:()=>{var e,t,l,s,o,i;if(!p)return;let a=[],r=[];if("normal"===q){let[e,t]=f.split(":").map(Number),[l,s]=S.split(":").map(Number),o=60*e+t,i=60*l+s;for(;o<=i;){let e=Math.floor(o/60),t=o%60,l=e.toString().padStart(2,"0"),s=t.toString().padStart(2,"0");a.push("".concat(l,":").concat(s)),o+=g}}else{let[e,t]=N.split(":").map(Number),[l,s]=y.split(":").map(Number),o=k+z;for(let i=e;i<=l;i++)for(let a=0;a<60;a+=o){if(i===e&&a<t||i===l&&a+k>s)continue;let o=i.toString().padStart(2,"0"),n=a.toString().padStart(2,"0");r.push({time:"".concat(o,":").concat(n),duration:k})}}let c={date:u(p),onlineSlots:null!=(t=null!=(e=null==F?void 0:F.onlineSlots)?e:null==F?void 0:F.slots)?t:[],inStudioSlots:null!=(l=null==F?void 0:F.inStudioSlots)?l:[],freeConsultationSlots:null!=(s=null==F?void 0:F.freeConsultationSlots)?s:[],studioSlots:null!=(o=null==F?void 0:F.studioSlots)?o:{}};if("normal"===q)if("online"===R)c.onlineSlots=a;else{if(!I)return void n.oR.error("Seleziona una sede prima di generare gli slot in studio");c.studioSlots={...null!=(i=null==F?void 0:F.studioSlots)?i:{},[I]:a}}else c.freeConsultationSlots=r;$(c)},className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:["⚡ ","normal"===q?"Genera slot normali":"Genera slot promozionali"]}),(0,s.jsx)(a.$,{onClick:Y,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:"\uD83D\uDCBE Salva"})]})]}),F&&(0,s.jsx)("div",{className:"mt-6 bg-card border border-border rounded-lg p-6 shadow-sm",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-xl font-semibold text-black",children:["\uD83D\uDCC5 Disponibilit\xe0 per ",p.toLocaleDateString("it-IT",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),(0,s.jsx)("p",{className:"text-sm text-black/70 mt-1",children:"promotional"===q?"\uD83C\uDFAF ".concat((null==(e=F.freeConsultationSlots)?void 0:e.length)||0," slot consultazioni gratuite configurati"):"online"===R?"\uD83D\uDCCB ".concat((null!=(m=null!=(d=F.onlineSlots)?d:F.slots)?m:[]).length," slot normali configurati (Online)"):"\uD83D\uDCCB ".concat(null!=(x=null==(l=F.studioSlots)||null==(t=l[I])?void 0:t.length)?x:0," slot normali configurati (Sede: ").concat(I||"—",")")})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(a.$,{type:"button",variant:"outline",size:"sm",onClick:()=>T(!L),className:"flex items-center gap-2",children:L?"❌ Chiudi":"➕ Aggiungi Orario"}),(0,s.jsx)(a.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{if(F){if("promotional"===q)$({...F,freeConsultationSlots:[]});else if("online"===R)$({...F,onlineSlots:[]});else{var e;if(!I)return void n.oR.error("Seleziona una sede");$({...F,studioSlots:{...null!=(e=F.studioSlots)?e:{},[I]:[]}})}n.oR.success("Tutti gli orari sono stati rimossi")}},className:"flex items-center gap-2 text-red-600 hover:text-red-700",children:"\uD83D\uDDD1️ Svuota tutti"})]})]}),L&&(0,s.jsxs)("div",{className:"p-4 border border-border rounded-lg space-y-4 bg-muted/20",children:[(0,s.jsxs)("div",{className:"flex gap-3 items-end",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(c,{label:"\uD83D\uDD50 Orario specifico",value:B,onChange:M})}),(0,s.jsx)(a.$,{type:"button",size:"md",onClick:()=>{B&&((e=>{if(F)if("promotional"===q){let t=F.freeConsultationSlots||[];if(Array.isArray(t)&&t.length>0&&"object"==typeof t[0]?t.some(t=>t.time===e):t.some(t=>"string"==typeof t&&t===e))n.oR.error("Lo slot promozionale ".concat(e," \xe8 gi\xe0 presente"));else{let l=[...t.map(e=>"object"==typeof e?e:{time:e,duration:k}),{time:e,duration:k}].sort((e,t)=>e.time.localeCompare(t.time));$({...F,freeConsultationSlots:l}),n.oR.success("Slot promozionale ".concat(e," aggiunto"))}}else{var t,l,s,o,i,a;let r="online"===R?null!=(s=null!=(l=F.onlineSlots)?l:F.slots)?s:[]:I?null!=(o=null==(t=F.studioSlots)?void 0:t[I])?o:[]:null!=(i=F.inStudioSlots)?i:[];if(r.includes(e))n.oR.error("L'orario ".concat(e," \xe8 gi\xe0 presente"));else{let t=[...r,e].sort();if("online"===R)$({...F,onlineSlots:t});else{if(!I)return n.oR.error("Seleziona una sede");$({...F,studioSlots:{...null!=(a=F.studioSlots)?a:{},[I]:t}})}n.oR.success("Orario ".concat(e," aggiunto"))}}})(B),M(""))},className:"flex items-center gap-2",children:"➕ Aggiungi"})]}),(0,s.jsx)("p",{className:"text-sm text-black/70",children:"promotional"===q?"\uD83C\uDFAF Aggiungi slot dedicati ai 10 minuti consultivi gratuiti":"\uD83D\uDCCB Aggiungi slot per consulenze normali"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium text-sm text-black flex items-center gap-2",children:"promotional"===q?"\uD83C\uDFAF Slot Consultazioni Gratuite Configurati:":"\uD83D\uDCCB Slot Normali Configurati:"}),(()=>{var e,t,l,o,i;let a="promotional"===q?F.freeConsultationSlots||[]:"online"===R?null!=(l=null!=(t=F.onlineSlots)?t:F.slots)?l:[]:I?null!=(o=null==(e=F.studioSlots)?void 0:e[I])?o:[]:null!=(i=F.inStudioSlots)?i:[];return a.length>0?(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:a.map(e=>{let t="promotional"===q,l=t&&"object"==typeof e?e.time:"string"==typeof e?e:"",o=t&&"object"==typeof e?e.duration:null;return(0,s.jsxs)("div",{className:"group relative p-3 border border-border rounded-lg bg-background hover:border-primary/50 transition-all duration-200",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-black",children:[(()=>{let e=/^\d{4}-\d{2}-\d{2}T(\d{2}):(\d{2})/.exec(l);return e?"".concat(e[1],":").concat(e[2]):l})(),o&&(0,s.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[o," min"]})]}),(0,s.jsx)("button",{type:"button",onClick:()=>(e=>{if(F){if("promotional"===q){let t,l=F.freeConsultationSlots||[];t=Array.isArray(l)&&l.length>0&&"object"==typeof l[0]?l.filter(t=>t.time!==e):l.filter(t=>"string"==typeof t?t!==e:t.time!==e).map(e=>"string"==typeof e?{time:e,duration:k}:e),$({...F,freeConsultationSlots:t})}else{var t,l,s,o,i,a;let r=("online"===R?null!=(s=null!=(l=F.onlineSlots)?l:F.slots)?s:[]:I?null!=(o=null==(t=F.studioSlots)?void 0:t[I])?o:[]:null!=(i=F.inStudioSlots)?i:[]).filter(t=>t!==e);if("online"===R)$({...F,onlineSlots:r});else{if(!I)return void n.oR.error("Seleziona una sede");$({...F,studioSlots:{...null!=(a=F.studioSlots)?a:{},[I]:r}})}}n.oR.success("Orario ".concat(e," rimosso"))}})(l),className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-red-600",title:"Rimuovi orario",children:"\xd7"})]},l)})}):(0,s.jsxs)("div",{className:"text-center py-8 text-black/70",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCC5"}),(0,s.jsx)("p",{className:"text-sm",children:"promotional"===q?"Nessuno slot dedicato configurato per questa data":"Nessuno slot disponibile per questa data"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:"Usa i controlli sopra per generare slot o aggiungi orari manualmente"})]})})()]})]})})]})}function u(e){let t=e=>String(e).padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()))}l(9157)},3998:(e,t,l)=>{"use strict";l.d(t,{$:()=>n});var s=l(5155),o=l(2115),i=l(5889),a=l(2821);let n=(0,o.forwardRef)((e,t)=>{let{className:l,variant:o="primary",size:n="md",fullWidth:r,...c}=e;return(0,s.jsx)("button",{ref:t,className:(0,i.QP)((0,a.$)("btn",{primary:"btn-primary",secondary:"btn-outline",ghost:"hover:bg-[color:var(--muted-bg)]",outline:"btn-outline"}[o],{sm:"px-3 py-1 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[n],r&&"w-full"),l),...c})});n.displayName="Button"},7001:(e,t,l)=>{Promise.resolve().then(l.bind(l,2063))}},e=>{e.O(0,[3038,9135,3965,5579,2545,8744,9719,2473,3237,576,8441,1255,7358],()=>e(e.s=7001)),_N_E=e.O()}]);