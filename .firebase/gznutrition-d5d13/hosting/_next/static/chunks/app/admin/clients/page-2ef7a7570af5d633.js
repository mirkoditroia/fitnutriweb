(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7097],{569:(e,t,a)=>{"use strict";a.d(t,{it:()=>x});let s={lessThanXSeconds:{one:"meno di un secondo",other:"meno di {{count}} secondi"},xSeconds:{one:"un secondo",other:"{{count}} secondi"},halfAMinute:"alcuni secondi",lessThanXMinutes:{one:"meno di un minuto",other:"meno di {{count}} minuti"},xMinutes:{one:"un minuto",other:"{{count}} minuti"},aboutXHours:{one:"circa un'ora",other:"circa {{count}} ore"},xHours:{one:"un'ora",other:"{{count}} ore"},xDays:{one:"un giorno",other:"{{count}} giorni"},aboutXWeeks:{one:"circa una settimana",other:"circa {{count}} settimane"},xWeeks:{one:"una settimana",other:"{{count}} settimane"},aboutXMonths:{one:"circa un mese",other:"circa {{count}} mesi"},xMonths:{one:"un mese",other:"{{count}} mesi"},aboutXYears:{one:"circa un anno",other:"circa {{count}} anni"},xYears:{one:"un anno",other:"{{count}} anni"},overXYears:{one:"pi\xf9 di un anno",other:"pi\xf9 di {{count}} anni"},almostXYears:{one:"quasi un anno",other:"quasi {{count}} anni"}};var r=a(3500);let n={date:(0,r.k)({formats:{full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},defaultWidth:"full"}),time:(0,r.k)({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:(0,r.k)({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})};var i=a(2859),o=a(2192);function l(e,t,a){let[s,r]=(0,i.x)(null==a?void 0:a.in,e,t);return+(0,o.k)(s,a)==+(0,o.k)(r,a)}let d=["domenica","luned\xec","marted\xec","mercoled\xec","gioved\xec","venerd\xec","sabato"];function c(e){return"'"+d[e]+" alle' p"}let m={lastWeek:(e,t,a)=>{let s=e.getDay();return l(e,t,a)?c(s):function(e){return 0===e?"'domenica scorsa alle' p":"'"+d[e]+" scorso alle' p"}(s)},yesterday:"'ieri alle' p",today:"'oggi alle' p",tomorrow:"'domani alle' p",nextWeek:(e,t,a)=>{let s=e.getDay();return l(e,t,a)?c(s):function(e){return 0===e?"'domenica prossima alle' p":"'"+d[e]+" prossimo alle' p"}(s)},other:"P"};var u=a(4690);let g={ordinalNumber:(e,t)=>String(Number(e)),era:(0,u.o)({values:{narrow:["aC","dC"],abbreviated:["a.C.","d.C."],wide:["avanti Cristo","dopo Cristo"]},defaultWidth:"wide"}),quarter:(0,u.o)({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1\xba trimestre","2\xba trimestre","3\xba trimestre","4\xba trimestre"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:(0,u.o)({values:{narrow:["G","F","M","A","M","G","L","A","S","O","N","D"],abbreviated:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],wide:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"]},defaultWidth:"wide"}),day:(0,u.o)({values:{narrow:["D","L","M","M","G","V","S"],short:["dom","lun","mar","mer","gio","ven","sab"],abbreviated:["dom","lun","mar","mer","gio","ven","sab"],wide:["domenica","luned\xec","marted\xec","mercoled\xec","gioved\xec","venerd\xec","sabato"]},defaultWidth:"wide"}),dayPeriod:(0,u.o)({values:{narrow:{am:"m.",pm:"p.",midnight:"mezzanotte",noon:"mezzogiorno",morning:"mattina",afternoon:"pomeriggio",evening:"sera",night:"notte"},abbreviated:{am:"AM",pm:"PM",midnight:"mezzanotte",noon:"mezzogiorno",morning:"mattina",afternoon:"pomeriggio",evening:"sera",night:"notte"},wide:{am:"AM",pm:"PM",midnight:"mezzanotte",noon:"mezzogiorno",morning:"mattina",afternoon:"pomeriggio",evening:"sera",night:"notte"}},defaultWidth:"wide",formattingValues:{narrow:{am:"m.",pm:"p.",midnight:"mezzanotte",noon:"mezzogiorno",morning:"di mattina",afternoon:"del pomeriggio",evening:"di sera",night:"di notte"},abbreviated:{am:"AM",pm:"PM",midnight:"mezzanotte",noon:"mezzogiorno",morning:"di mattina",afternoon:"del pomeriggio",evening:"di sera",night:"di notte"},wide:{am:"AM",pm:"PM",midnight:"mezzanotte",noon:"mezzogiorno",morning:"di mattina",afternoon:"del pomeriggio",evening:"di sera",night:"di notte"}},defaultFormattingWidth:"wide"})};var h=a(1250);let x={code:"it",formatDistance:(e,t,a)=>{let r,n=s[e];if(r="string"==typeof n?n:1===t?n.one:n.other.replace("{{count}}",t.toString()),null==a?void 0:a.addSuffix)if(a.comparison&&a.comparison>0)return"tra "+r;else return r+" fa";return r},formatLong:n,formatRelative:(e,t,a,s)=>{let r=m[e];return"function"==typeof r?r(t,a,s):r},localize:g,match:{ordinalNumber:(0,a(3904).K)({matchPattern:/^(\d+)(º)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:(0,h.A)({matchPatterns:{narrow:/^(aC|dC)/i,abbreviated:/^(a\.?\s?C\.?|a\.?\s?e\.?\s?v\.?|d\.?\s?C\.?|e\.?\s?v\.?)/i,wide:/^(avanti Cristo|avanti Era Volgare|dopo Cristo|Era Volgare)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^a/i,/^(d|e)/i]},defaultParseWidth:"any"}),quarter:(0,h.A)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^t[1234]/i,wide:/^[1234](º)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:(0,h.A)({matchPatterns:{narrow:/^[gfmalsond]/i,abbreviated:/^(gen|feb|mar|apr|mag|giu|lug|ago|set|ott|nov|dic)/i,wide:/^(gennaio|febbraio|marzo|aprile|maggio|giugno|luglio|agosto|settembre|ottobre|novembre|dicembre)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^g/i,/^f/i,/^m/i,/^a/i,/^m/i,/^g/i,/^l/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ge/i,/^f/i,/^mar/i,/^ap/i,/^mag/i,/^gi/i,/^l/i,/^ag/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:(0,h.A)({matchPatterns:{narrow:/^[dlmgvs]/i,short:/^(do|lu|ma|me|gi|ve|sa)/i,abbreviated:/^(dom|lun|mar|mer|gio|ven|sab)/i,wide:/^(domenica|luned[i|ì]|marted[i|ì]|mercoled[i|ì]|gioved[i|ì]|venerd[i|ì]|sabato)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^g/i,/^v/i,/^s/i],any:[/^d/i,/^l/i,/^ma/i,/^me/i,/^g/i,/^v/i,/^s/i]},defaultParseWidth:"any"}),dayPeriod:(0,h.A)({matchPatterns:{narrow:/^(a|m\.|p|mezzanotte|mezzogiorno|(di|del) (mattina|pomeriggio|sera|notte))/i,any:/^([ap]\.?\s?m\.?|mezzanotte|mezzogiorno|(di|del) (mattina|pomeriggio|sera|notte))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mezza/i,noon:/^mezzo/i,morning:/mattina/i,afternoon:/pomeriggio/i,evening:/sera/i,night:/notte/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:4}}},3678:(e,t,a)=>{"use strict";a.d(t,{s:()=>o});var s=a(5155),r=a(2115),n=a(3998),i=a(2663);function o(e){let{folder:t,onUploaded:a,accept:o=".pdf,.doc,.docx,.jpg,.jpeg,.png",maxSize:l=10}=e,[d,c]=(0,r.useState)(!1),m=(0,r.useId)(),u=(0,r.useRef)(null),g=async e=>{var s;let r=null==(s=e.target.files)?void 0:s[0];if(r){if(r.size>1024*l*1024)return void i.oR.error("File troppo grande. Dimensione massima: ".concat(l,"MB"));c(!0);try{let e=new FormData;e.append("file",r),e.append("folder",t),console.log("[UploadButton] Caricamento file: ".concat(r.name," (").concat(r.size," bytes)"));let s=await fetch("/api/upload",{method:"POST",body:e});if(!s.ok){let e=await s.text();throw console.error("[UploadButton] Upload fallito: ".concat(s.status," - ").concat(e)),Error("Upload fallito: ".concat(s.status))}let n=await s.json();if(n.error)throw console.error("[UploadButton] Errore server:",n.error),Error("Errore server: ".concat(n.error));if(!n.url)throw console.error("[UploadButton] Nessun URL ritornato:",n),Error("Nessun URL ritornato dal server");console.log("[UploadButton] Upload completato: ".concat(n.url)),i.oR.success("File caricato con successo!"),a(n.url)}catch(t){console.error("Upload error:",t);let e=t instanceof Error?t.message:"Errore sconosciuto";i.oR.error("Errore caricamento: ".concat(e))}finally{if(c(!1),e.target)try{e.target.value=""}catch(e){}}}};return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{ref:u,type:"file",accept:o,onChange:g,className:"hidden",id:"upload-".concat(t,"-").concat(m),disabled:d}),(0,s.jsx)(n.$,{type:"button",variant:"outline",disabled:d,className:"cursor-pointer",onClick:()=>{var e;return!d&&(null==(e=u.current)?void 0:e.click())},children:d?"⏳ Caricamento...":"\uD83D\uDCC1 Carica File"}),(0,s.jsxs)("span",{className:"text-xs text-foreground/60",children:["Max ",l,"MB"]})]})}},3998:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var s=a(5155),r=a(2115),n=a(5889),i=a(2821);let o=(0,r.forwardRef)((e,t)=>{let{className:a,variant:r="primary",size:o="md",fullWidth:l,...d}=e;return(0,s.jsx)("button",{ref:t,className:(0,n.QP)((0,i.$)("btn",{primary:"btn-primary",secondary:"btn-outline",ghost:"hover:bg-[color:var(--muted-bg)]",outline:"btn-outline"}[r],{sm:"px-3 py-1 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[o],l&&"w-full"),a),...d})});o.displayName="Button"},5142:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var s=a(5155),r=a(2115),n=a(5889);let i=(0,r.forwardRef)((e,t)=>{let{className:a,label:r,error:i,id:o,...l}=e,d=o||l.name||"input";return(0,s.jsxs)("div",{className:"w-full",children:[r&&(0,s.jsx)("label",{htmlFor:d,className:"block text-sm font-medium mb-1 text-foreground",children:r}),(0,s.jsx)("input",{id:d,ref:t,className:(0,n.QP)("w-full rounded-lg border border-foreground/10 bg-background/70 backdrop-blur-sm px-3.5 py-2.5 text-sm text-foreground placeholder:text-foreground/50","focus:outline-none focus:ring-4 focus:ring-[rgba(var(--primary-rgb),0.15)] focus:ring-offset-0",i&&"border-accent",a),"aria-invalid":!!i,"aria-describedby":i?"".concat(d,"-error"):void 0,...l}),i&&(0,s.jsx)("p",{id:"".concat(d,"-error"),className:"mt-1 text-xs text-destructive",children:i})]})});i.displayName="Input"},6156:(e,t,a)=>{Promise.resolve().then(a.bind(a,9757))},9757:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(5155),r=a(2115),n=a(9018),i=a(3998),o=a(5142),l=a(2663),d=a(3678),c=a(2473),m=a(569);function u(e){var t,a;let{client:n,progressData:l=[],onSave:d,onExportPDF:u}=e,[g,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)({date:(0,c.GP)(new Date,"yyyy-MM-dd"),weight:void 0,bodyFat:void 0,muscleMass:void 0,measurements:{},notes:"",photos:[]}),f=async()=>{try{await d(n.id,x),h(!1),p({date:(0,c.GP)(new Date,"yyyy-MM-dd"),weight:void 0,bodyFat:void 0,muscleMass:void 0,measurements:{},notes:"",photos:[]})}catch(e){console.error("Error saving progress:",e)}};return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:n.name.charAt(0).toUpperCase()}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:n.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:n.email}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:n.phone})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"inactive":default:return"bg-gray-100 text-gray-800";case"prospect":return"bg-blue-100 text-blue-800"}})(n.status)),children:(e=>{switch(e){case"active":return"Attivo";case"inactive":return"Inattivo";case"prospect":return"Prospect";default:return e}})(n.status)}),(0,s.jsx)(i.$,{onClick:()=>u(n.id),variant:"outline",size:"sm",className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:"\uD83D\uDCCA Export PDF"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Cliente dal"}),(0,s.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:(0,c.GP)(new Date(n.createdAt),"dd MMM yyyy",{locale:m.it})})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Ultimo aggiornamento"}),(0,s.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:l.length>0?(0,c.GP)(new Date(l[0].date),"dd/MM/yyyy",{locale:m.it}):"-"})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Progressi registrati"}),(0,s.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:l.length})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:"\uD83D\uDCC8 Storico Progressi"}),(0,s.jsx)(i.$,{onClick:()=>h(!g),size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:g?"Annulla":"+ Nuovo Progresso"})]}),g&&(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,s.jsx)("h5",{className:"font-medium text-blue-900 mb-3",children:"Aggiungi Nuovo Progresso"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data"}),(0,s.jsx)(o.p,{type:"date",value:x.date,onChange:e=>p(t=>({...t,date:e.target.value}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Peso (kg)"}),(0,s.jsx)(o.p,{type:"number",step:"0.1",placeholder:"es. 70.5",value:x.weight||"",onChange:e=>p(t=>({...t,weight:e.target.value?parseFloat(e.target.value):void 0}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Massa Grassa (%)"}),(0,s.jsx)(o.p,{type:"number",step:"0.1",placeholder:"es. 15.2",value:x.bodyFat||"",onChange:e=>p(t=>({...t,bodyFat:e.target.value?parseFloat(e.target.value):void 0}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Massa Muscolare (kg)"}),(0,s.jsx)(o.p,{type:"number",step:"0.1",placeholder:"es. 35.8",value:x.muscleMass||"",onChange:e=>p(t=>({...t,muscleMass:e.target.value?parseFloat(e.target.value):void 0}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vita (cm)"}),(0,s.jsx)(o.p,{type:"number",step:"0.1",placeholder:"es. 85.0",value:(null==(t=x.measurements)?void 0:t.waist)||"",onChange:e=>p(t=>({...t,measurements:{...t.measurements,waist:e.target.value?parseFloat(e.target.value):void 0}}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Petto (cm)"}),(0,s.jsx)(o.p,{type:"number",step:"0.1",placeholder:"es. 95.0",value:(null==(a=x.measurements)?void 0:a.chest)||"",onChange:e=>p(t=>({...t,measurements:{...t.measurements,chest:e.target.value?parseFloat(e.target.value):void 0}}))})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note"}),(0,s.jsx)("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Note aggiuntive sui progressi...",value:x.notes||"",onChange:e=>p(t=>({...t,notes:e.target.value}))})]}),(0,s.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,s.jsx)(i.$,{onClick:f,className:"bg-green-600 hover:bg-green-700",children:"\uD83D\uDCBE Salva Progresso"}),(0,s.jsx)(i.$,{onClick:()=>h(!1),variant:"outline",children:"Annulla"})]})]}),l.length>0?(0,s.jsx)("div",{className:"space-y-3",children:l.map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,s.jsx)("span",{className:"font-medium text-gray-900",children:(0,c.GP)(new Date(e.date),"dd MMM yyyy",{locale:m.it})})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.weight&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Peso:"}),(0,s.jsxs)("span",{className:"ml-1 font-medium",children:[e.weight," kg"]})]}),e.bodyFat&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Massa Grassa:"}),(0,s.jsxs)("span",{className:"ml-1 font-medium",children:[e.bodyFat,"%"]})]}),e.muscleMass&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Massa Muscolare:"}),(0,s.jsxs)("span",{className:"ml-1 font-medium",children:[e.muscleMass," kg"]})]}),(null==(a=e.measurements)?void 0:a.waist)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Vita:"}),(0,s.jsxs)("span",{className:"ml-1 font-medium",children:[e.measurements.waist," cm"]})]})]}),e.notes&&(0,s.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:[(0,s.jsx)("span",{className:"font-medium",children:"Note:"})," ",e.notes]})]},e.id||t)})}):(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,s.jsx)("p",{className:"text-gray-600 text-center py-8",children:"\uD83D\uDCCA Nessun progresso registrato ancora. Aggiungi il primo per iniziare a tracciare i risultati!"})})]}),n.notes&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"\uD83D\uDCDD Note Cliente"}),(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,s.jsx)("p",{className:"text-gray-700",children:n.notes})})]})]})}function g(e){let{data:t,type:a,onExportPDF:n}=e,o=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!o.current||0===t.length)return;let e=o.current,s=e.getContext("2d");if(!s)return;e.width=2*e.offsetWidth,e.height=2*e.offsetHeight,s.scale(2,2),s.clearRect(0,0,e.offsetWidth,e.offsetHeight);let r=e.offsetWidth-60-20,n=e.offsetHeight-20-40,i=t.filter(e=>{switch(a){case"weight":return void 0!==e.weight;case"bodyFat":return void 0!==e.bodyFat;case"muscleMass":return void 0!==e.muscleMass;case"measurements":return e.measurements&&(e.measurements.waist||e.measurements.chest);default:return!1}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());if(0===i.length){s.fillStyle="#6B7280",s.font="16px Arial",s.textAlign="center",s.fillText("Nessun dato disponibile",e.offsetWidth/2,e.offsetHeight/2);return}let d=i.map(e=>{switch(a){case"weight":return e.weight;case"bodyFat":return e.bodyFat;case"muscleMass":return e.muscleMass;case"measurements":var t,s;return(null==(t=e.measurements)?void 0:t.waist)||(null==(s=e.measurements)?void 0:s.chest)||0;default:return 0}}),c=Math.min(...d),m=Math.max(...d),u=m-c,g=.1*u,h=e=>60+e/(i.length-1)*r,x=e=>20+n-(e-c+g)/(u+2*g)*n;s.strokeStyle="#E5E7EB",s.lineWidth=1,s.beginPath(),s.moveTo(60,20),s.lineTo(60,20+n),s.stroke(),s.beginPath(),s.moveTo(60,20+n),s.lineTo(60+r,20+n),s.stroke(),s.strokeStyle="#F3F4F6",s.lineWidth=.5;for(let e=0;e<=5;e++){let t=20+e/5*n;s.beginPath(),s.moveTo(60,t),s.lineTo(60+r,t),s.stroke()}s.strokeStyle="#3B82F6",s.lineWidth=3,s.beginPath(),i.forEach((e,t)=>{let a=h(t),r=x(d[t]);0===t?s.moveTo(a,r):s.lineTo(a,r)}),s.stroke(),s.fillStyle="#3B82F6",i.forEach((e,t)=>{let a=h(t),r=x(d[t]);s.beginPath(),s.arc(a,r,4,0,2*Math.PI),s.fill()}),s.fillStyle="#374151",s.font="12px Arial",s.textAlign="center";for(let e=0;e<=5;e++){let t=c+(m-c)*(1-e/5),a=20+e/5*n;s.fillText(t.toFixed(1),50,a+4)}i.forEach((e,t)=>{if(t%Math.ceil(i.length/5)==0){let a=h(t),r=new Date(e.date),i="".concat(r.getDate(),"/").concat(r.getMonth()+1);s.fillText(i,a,20+n+20)}}),s.fillStyle="#111827",s.font="bold 16px Arial",s.textAlign="center";let p=l(a);s.fillText(p,e.offsetWidth/2,20)},[t,a]);let l=e=>{switch(e){case"weight":return"Andamento Peso (kg)";case"bodyFat":return"Massa Grassa (%)";case"muscleMass":return"Massa Muscolare (kg)";case"measurements":return"Misure Corporee (cm)";default:return"Grafico Progressi"}};return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:l(a)}),(0,s.jsx)(i.$,{onClick:n,size:"sm",className:"bg-red-600 hover:bg-red-700",children:"\uD83D\uDCC4 Export PDF"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("canvas",{ref:o,className:"w-full h-64 border border-gray-200 rounded-lg",style:{maxHeight:"400px"}}),0===t.length&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCCA"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Nessun dato disponibile"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Aggiungi progressi per visualizzare il grafico"})]})})]})]})}function h(){let[e,t]=(0,r.useState)([]),[a,m]=(0,r.useState)([]),[h,x]=(0,r.useState)([]),[p,f]=(0,r.useState)(!0),[b,v]=(0,r.useState)("list"),[y,j]=(0,r.useState)(null),[N,w]=(0,r.useState)(""),[D,C]=(0,r.useState)({}),M=async()=>{try{let[e,a,s]=await Promise.all([(0,n.listClients)(),(0,n.getPackages)(),(0,n.listBookings)()]);t(e),m(a),x(s);let r=e.map(async e=>{if(e.id){let t=await (0,n.getClientProgress)(e.id);return{clientId:e.id,progress:t}}return null}),i=await Promise.all(r),o={};i.forEach(e=>{e&&(o[e.clientId]=e.progress)}),C(o)}catch(e){console.error("Error loading data:",e),l.oR.error("Errore nel caricamento dei dati")}finally{f(!1)}};(0,r.useEffect)(()=>{M()},[]);let P=async(e,t)=>{try{let a={id:await (0,n.saveClientProgress)({clientId:e,...t}),clientId:e,...t,createdAt:new Date().toISOString()};C(t=>({...t,[e]:[a,...t[e]||[]]})),l.oR.success("Progresso salvato con successo!")}catch(e){console.error("Error saving progress:",e),l.oR.error("Errore nel salvare il progresso")}},k=async t=>{try{let a=e.find(e=>e.id===t);if(!a)return;let s=D[t]||[],r=await (0,n.getSiteContent)(),i=(null==r?void 0:r.siteName)||"GZnutrition",o=window.open("","_blank");if(!o)return;let l=new Date().toLocaleDateString("it-IT"),d='\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <meta charset="UTF-8">\n            <title>Report Progressi - '.concat(a.name,'</title>\n            <style>\n              body { font-family: Arial, sans-serif; margin: 20px; }\n              .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #3B82F6; padding-bottom: 20px; }\n              .client-info { background: #F9FAFB; padding: 20px; border-radius: 8px; margin-bottom: 30px; }\n              .progress-table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n              .progress-table th, .progress-table td { border: 1px solid #D1D5DB; padding: 12px; text-align: left; }\n              .progress-table th { background: #F3F4F6; font-weight: bold; }\n              .footer { margin-top: 40px; text-align: center; color: #6B7280; font-size: 12px; }\n            </style>\n          </head>\n          <body>\n            <div class="header">\n              <h1>\uD83D\uDCCA Report Progressi Cliente</h1>\n              <p>Generato il ').concat(l," - ").concat(i,'</p>\n            </div>\n            <div class="client-info">\n              <h2>\uD83D\uDC64 ').concat(a.name,"</h2>\n              <p><strong>Email:</strong> ").concat(a.email,"</p>\n              <p><strong>Telefono:</strong> ").concat(a.phone,"</p>\n            </div>\n            ").concat(s.length>0?'\n              <h2>\uD83D\uDCC8 Storico Progressi</h2>\n              <table class="progress-table">\n                <thead>\n                  <tr>\n                    <th>Data</th>\n                    <th>Peso (kg)</th>\n                    <th>Massa Grassa (%)</th>\n                    <th>Massa Muscolare (kg)</th>\n                    <th>Vita (cm)</th>\n                    <th>Petto (cm)</th>\n                    <th>Note</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  '.concat(s.map(e=>{var t,a;return"\n                    <tr>\n                      <td>".concat(new Date(e.date).toLocaleDateString("it-IT"),"</td>\n                      <td>").concat(e.weight||"-","</td>\n                      <td>").concat(e.bodyFat||"-","</td>\n                      <td>").concat(e.muscleMass||"-","</td>\n                      <td>").concat((null==(t=e.measurements)?void 0:t.waist)||"-","</td>\n                      <td>").concat((null==(a=e.measurements)?void 0:a.chest)||"-","</td>\n                      <td>").concat(e.notes||"-","</td>\n                    </tr>\n                  ")}).join(""),"\n                </tbody>\n              </table>\n            "):"<p>Nessun progresso registrato ancora.</p>",'\n            <div class="footer">\n              <p>Report generato automaticamente da ').concat(i,"</p>\n            </div>\n          </body>\n        </html>\n      ");o.document.write(d),o.document.close(),o.onload=()=>{setTimeout(()=>{o.print(),o.close()},500)}}catch(e){console.error("Error exporting PDF:",e),l.oR.error("Errore nell'export del PDF")}},z=()=>{j({name:"",email:"",phone:"",notes:"",createdAt:new Date().toISOString(),id:crypto.randomUUID()}),v("create")},E=async e=>{try{await (0,n.upsertClient)(e),l.oR.success("Cliente salvato con successo!"),await M(),v("list"),j(null)}catch(e){console.error("Error saving client:",e),l.oR.error("Errore nel salvare il cliente")}},F=async e=>{if(window.confirm("Sei sicuro di voler eliminare questo cliente? Questa azione non pu\xf2 essere annullata."))try{await (0,n.deleteClient)(e),l.oR.success("Cliente eliminato con successo!"),await M(),"detail"===b&&(v("list"),j(null))}catch(e){console.error("Error deleting client:",e),l.oR.error("Errore nell'eliminazione del cliente")}},S=(e,t,a)=>{if(!y)return;let s={id:crypto.randomUUID(),name:"".concat(t,"_").concat((0,c.GP)(new Date,"yyyy-MM-dd")),url:a,type:t,uploadedAt:new Date().toISOString()},r={...y,documents:[...y.documents||[],s]};j(r),E(r)},A=e.filter(e=>e.name.toLowerCase().includes(N.toLowerCase())||e.email.toLowerCase().includes(N.toLowerCase()));if(p)return(0,s.jsxs)("main",{className:"container py-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Gestione Clienti"}),(0,s.jsx)("p",{className:"mt-4 text-foreground/70",children:"Caricamento..."})]});let W=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=D[e.id]||[];return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(i.$,{onClick:()=>{v("list"),j(null)},variant:"outline",size:"sm",children:"← Torna alla Lista"}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:t?"Nuovo Cliente":"Dettaglio Cliente"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.$,{onClick:()=>E(e),className:"bg-green-600 hover:bg-green-700",children:"\uD83D\uDCBE Salva Modifiche"}),!t&&(0,s.jsx)(i.$,{onClick:()=>F(e.id),className:"bg-red-600 hover:bg-red-700",children:"\uD83D\uDDD1️ Elimina Cliente"})]})]}),(0,s.jsx)(u,{client:{id:e.id||"",name:e.name||"",email:e.email||"",phone:e.phone||"",status:"active",notes:e.notes||"",createdAt:e.createdAt||new Date().toISOString()},progressData:a,onSave:P,onExportPDF:k}),a.length>0&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)(g,{data:a,type:"weight",onExportPDF:()=>k(e.id)}),(0,s.jsx)(g,{data:a,type:"bodyFat",onExportPDF:()=>k(e.id)}),(0,s.jsx)(g,{data:a,type:"muscleMass",onExportPDF:()=>k(e.id)}),(0,s.jsx)(g,{data:a,type:"measurements",onExportPDF:()=>k(e.id)})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6",children:(0,s.jsxs)("details",{className:"group",children:[(0,s.jsxs)("summary",{className:"cursor-pointer text-lg font-semibold text-gray-900 mb-4 list-none",children:[(0,s.jsx)("span",{className:"group-open:hidden",children:"\uD83D\uDCCB Mostra Informazioni Dettagliate"}),(0,s.jsx)("span",{className:"hidden group-open:inline",children:"\uD83D\uDCCB Nascondi Informazioni Dettagliate"})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("section",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"\uD83D\uDC64 Informazioni Base"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Nome Completo *"}),(0,s.jsx)(o.p,{value:e.name,onChange:t=>j({...e,name:t.target.value}),placeholder:"es. Mario Rossi"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Email *"}),(0,s.jsx)(o.p,{type:"email",value:e.email,onChange:t=>j({...e,email:t.target.value}),placeholder:"es. mario.rossi@email.com"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Telefono *"}),(0,s.jsx)(o.p,{type:"tel",value:e.phone,onChange:t=>j({...e,phone:t.target.value}),placeholder:"es. +39 123 456 7890"})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Note"}),(0,s.jsx)("textarea",{value:e.notes,onChange:t=>j({...e,notes:t.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Note aggiuntive sul cliente..."})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"\uD83D\uDCC4 Documenti"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Carica Certificato Medico"}),(0,s.jsx)(d.s,{folder:"clients/medical",onUploaded:t=>S(e.id,"medical_certificate",t)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Carica Documento d'Identit\xe0"}),(0,s.jsx)(d.s,{folder:"clients/documents",onUploaded:t=>S(e.id,"id_document",t)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Carica Modulo Consenso"}),(0,s.jsx)(d.s,{folder:"clients/consent",onUploaded:t=>S(e.id,"consent_form",t)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Carica Altro Documento"}),(0,s.jsx)(d.s,{folder:"clients/other",onUploaded:t=>S(e.id,"other",t)})]})]}),e.documents&&e.documents.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium mb-2",children:"Documenti caricati:"}),(0,s.jsx)("div",{className:"space-y-2",children:e.documents.map(t=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-lg",children:"medical_certificate"===t.type?"\uD83C\uDFE5":"id_document"===t.type?"\uD83C\uDD94":"consent_form"===t.type?"\uD83D\uDCDD":"\uD83D\uDCC4"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:t.name}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Caricato il ",(0,c.GP)(new Date(t.uploadedAt),"dd/MM/yyyy")]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline",children:"Visualizza"}),(0,s.jsx)(i.$,{onClick:()=>((e,t)=>{var a;if(!y)return;let s={...y,documents:(null==(a=y.documents)?void 0:a.filter(e=>e.id!==t))||[]};j(s),E(s)})(e.id,t.id),className:"bg-red-600 hover:bg-red-700",size:"sm",children:"\uD83D\uDDD1️"})]})]},t.id))})]})]})]})]})]})})]})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-foreground pt-4",children:"Clienti"}),"list"===b&&(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(o.p,{placeholder:"Cerca per nome o email...",value:N,onChange:e=>w(e.target.value),className:"w-full"})}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(i.$,{onClick:z,className:"bg-blue-600 hover:bg-blue-700",children:"+ Nuovo Cliente"})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 hover:shadow-lg transition-shadow",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:e.name.charAt(0).toUpperCase()}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.email}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.phone})]})]}),(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Cliente dal ",(0,c.GP)(new Date(e.createdAt||new Date),"dd/MM/yyyy")]})}),e.notes&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:e.notes}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.$,{onClick:()=>{j(e),v("detail")},variant:"outline",size:"sm",className:"flex-1",children:"\uD83D\uDC41️ Visualizza"}),(0,s.jsx)(i.$,{onClick:()=>F(e.id),className:"bg-red-600 hover:bg-red-700",size:"sm",children:"\uD83D\uDDD1️"})]})]},e.id))}),0===A.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDC65"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Nessun cliente trovato"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:N?"Prova a modificare i filtri di ricerca":"Inizia aggiungendo il tuo primo cliente"}),!N&&(0,s.jsx)(i.$,{onClick:z,className:"bg-blue-600 hover:bg-blue-700",children:"+ Aggiungi Primo Cliente"})]})]}),"detail"===b&&y&&W(y),"create"===b&&y&&W(y,!0)]})}}},e=>{e.O(0,[9135,3965,8744,9719,2473,9018,8441,1255,7358],()=>e(e.s=6156)),_N_E=e.O()}]);