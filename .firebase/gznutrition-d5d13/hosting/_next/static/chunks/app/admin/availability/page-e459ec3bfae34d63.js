(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8816],{2063:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>d});var s=l(5155),i=l(2115),a=l(9018),o=l(3998),n=l(2663),r=l(740);function c(e){let{value:t,onChange:l,label:a}=e,[n,r]=(0,i.useState)(!1),[c,d]=(0,i.useState)(9),[u,m]=(0,i.useState)(0);(0,i.useEffect)(()=>{if(t){let[e,l]=t.split(":").map(Number);d(e),m(l)}},[t]);let x=Array.from({length:24},(e,t)=>t),b=Array.from({length:12},(e,t)=>5*t);return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:a}),(0,s.jsxs)("div",{className:"w-full p-2 border border-border rounded bg-white text-black cursor-pointer hover:border-primary/50 transition-colors flex items-center justify-between",onClick:()=>r(!n),children:[(0,s.jsx)("span",{className:t?"text-black":"text-black/70",children:t||"Seleziona orario"}),(0,s.jsx)("span",{className:"text-black/70",children:"\uD83D\uDD50"})]}),n&&(0,s.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-background border border-border rounded-lg shadow-lg z-50 p-4 min-w-[280px]",children:[(0,s.jsx)("div",{className:"text-center mb-4",children:(0,s.jsx)("h4",{className:"font-medium text-black",children:"Seleziona Orario"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-center",children:"Ore"}),(0,s.jsx)("div",{className:"max-h-32 overflow-y-auto border border-border rounded p-2",children:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-1",children:x.map(e=>(0,s.jsx)("button",{onClick:()=>d(e),className:"p-2 text-sm rounded transition-colors ".concat(c===e?"bg-primary text-primary-foreground":"hover:bg-muted"),children:e.toString().padStart(2,"0")},e))})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-center",children:"Minuti"}),(0,s.jsx)("div",{className:"max-h-32 overflow-y-auto border border-border rounded p-2",children:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-1",children:b.map(e=>(0,s.jsx)("button",{onClick:()=>m(e),className:"p-2 text-sm rounded transition-colors ".concat(u===e?"bg-primary text-primary-foreground":"hover:bg-muted"),children:e.toString().padStart(2,"0")},e))})})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(o.$,{onClick:()=>{l("".concat(c.toString().padStart(2,"0"),":").concat(u.toString().padStart(2,"0"))),r(!1)},className:"flex-1",children:"Conferma"}),(0,s.jsx)(o.$,{variant:"outline",onClick:()=>r(!1),className:"flex-1",children:"Annulla"})]}),(0,s.jsx)("div",{className:"fixed inset-0 -z-10",onClick:()=>r(!1)})]})]})}function d(){var e,t,l,d,m,x;let[b,p]=(0,i.useState)(new Date),[g,h]=(0,i.useState)(60),[f,v]=(0,i.useState)("09:00"),[S,j]=(0,i.useState)("18:00"),[N,D]=(0,i.useState)("09:00"),[C,k]=(0,i.useState)("18:00"),[y,w]=(0,i.useState)(10),[z,F]=(0,i.useState)(10),[$,A]=(0,i.useState)(null),[R,E]=(0,i.useState)("online"),[O,G]=(0,i.useState)([]),[I,_]=(0,i.useState)(""),[B,M]=(0,i.useState)(""),[T,q]=(0,i.useState)(!1),[L,P]=(0,i.useState)("normal"),Q=u(b),U=(0,i.useCallback)(async()=>{let e=await (0,a.getAvailabilityByDate)(Q);e?A(e):A({date:Q,onlineSlots:[],inStudioSlots:[],freeConsultationSlots:[],studioSlots:{}})},[Q]);(0,i.useEffect)(()=>{let e=!0;return(async()=>{try{var t,l;let s=await (0,a.getSiteContent)();if(!e)return;let i=null!=(l=null==s?void 0:s.contactAddresses)?l:[];G(i),!I&&(null==(t=i[0])?void 0:t.name)&&_(i[0].name)}catch(e){}})(),()=>{e=!1}},[I]);let Y=async()=>{if($){var e,t,l,s;await (0,a.upsertAvailabilityForDate)(Q,null!=(t=null!=(e=$.onlineSlots)?e:$.slots)?t:[],$.freeConsultationSlots,null!=(l=$.inStudioSlots)?l:[],null!=(s=$.studioSlots)?s:{}),n.oR.success("Disponibilit\xe0 salvata")}};return(0,i.useEffect)(()=>{U()},[Q,U]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-black pt-4",children:"\uD83D\uDCC5 Gestione Disponibilit\xe0"}),(0,s.jsxs)("div",{className:"bg-card border border-border rounded-lg p-6 mt-4 space-y-6 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,s.jsx)(o.$,{variant:"normal"===L?"primary":"outline",onClick:()=>P("normal"),className:"flex items-center gap-2 px-6 py-3",children:"\uD83D\uDCC5 Slot Normali"}),(0,s.jsx)(o.$,{variant:"promotional"===L?"primary":"outline",onClick:()=>P("promotional"),className:"flex items-center gap-2 px-6 py-3",children:"\uD83C\uDFAF Slot Consultazioni Gratuite"}),"normal"===L&&(0,s.jsxs)("div",{className:"ml-auto flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-sm text-black",children:"Sede:"}),(0,s.jsx)(o.$,{variant:"online"===R?"primary":"outline",onClick:()=>E("online"),className:"px-4 py-2",children:"\uD83C\uDF10 Online"}),(0,s.jsx)(o.$,{variant:"studio"===R?"primary":"outline",onClick:()=>E("studio"),className:"px-4 py-2",children:"\uD83C\uDFE2 In studio"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"\uD83D\uDCC5 Data"}),(0,s.jsx)(r.Ay,{selected:b,onChange:e=>e&&p(e),dateFormat:"dd/MM/yyyy",className:"w-full rounded-md border border-border bg-white px-3 py-2 text-sm text-black placeholder:text-black/70",minDate:new Date})]}),"normal"===L&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c,{label:"\uD83D\uDD50 Inizio",value:f,onChange:v}),(0,s.jsx)(c,{label:"\uD83D\uDD50 Fine",value:S,onChange:j}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"⏱️ Intervallo (min)"}),(0,s.jsx)("input",{type:"number",min:"5",max:"120",step:"5",value:g,onChange:e=>h(Number(e.target.value)),className:"w-full p-2 border border-border rounded bg-white text-black placeholder:text-black/70"}),(0,s.jsx)("p",{className:"text-xs text-black/70 mt-1",children:"Solo multipli di 5"})]}),"studio"===R&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"\uD83C\uDFE2 Sede"}),(0,s.jsx)("select",{value:I,onChange:e=>_(e.target.value),className:"w-full p-2 border border-border rounded bg-white text-black placeholder:text-black/70",children:O.map((e,t)=>(0,s.jsx)("option",{value:e.name,children:e.name},t))})]})]}),"promotional"===L&&(0,s.jsxs)("div",{className:"col-span-3 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsx)(c,{label:"\uD83D\uDD50 Inizio consultazioni gratuite",value:N,onChange:D}),(0,s.jsx)(c,{label:"\uD83D\uDD50 Fine consultazioni gratuite",value:C,onChange:k})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"⏱️ Durata consultazione (minuti)"}),(0,s.jsx)("input",{type:"number",min:"5",max:"60",step:"5",value:y,onChange:e=>w(Number(e.target.value)),className:"w-full p-2 border border-border rounded bg-white text-black placeholder:text-black/70"}),(0,s.jsx)("p",{className:"text-xs text-black/70 mt-1",children:"Solo multipli di 5"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"⏱️ Gap tra consultazioni (minuti)"}),(0,s.jsx)("input",{type:"number",min:"5",max:"30",step:"5",value:z,onChange:e=>F(Number(e.target.value)),className:"w-full p-2 border border-border rounded bg-white text-black placeholder:text-black/70"}),(0,s.jsx)("p",{className:"text-xs text-black/70 mt-1",children:"Solo multipli di 5"})]})]}),(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,s.jsx)("strong",{children:"ℹ️ Informazioni:"})," Gli slot promozionali vengono generati automaticamente con durata di ",y," minuti e gap di ",z," minuti tra le consultazioni, nel range di ore specificato.",(0,s.jsx)("br",{}),(0,s.jsxs)("span",{className:"text-xs mt-2 block",children:[(0,s.jsx)("strong",{children:"Esempio:"})," con durata ",y," min e gap ",z," min, ogni slot sar\xe0 distanziato di ",y+z," minuti."]})]})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-border",children:[(0,s.jsx)(o.$,{onClick:U,variant:"outline",className:"flex items-center gap-2",children:"\uD83D\uDD04 Carica esistenti"}),(0,s.jsxs)(o.$,{onClick:()=>{var e,t,l,s,i,a;if(!b)return;let o=[],r=[];if("normal"===L){let[e,t]=f.split(":").map(Number),[l,s]=S.split(":").map(Number),i=60*e+t,a=60*l+s;for(;i<=a;){let e=Math.floor(i/60),t=i%60,l=e.toString().padStart(2,"0"),s=t.toString().padStart(2,"0");o.push("".concat(l,":").concat(s)),i+=g}}else{let[e,t]=N.split(":").map(Number),[l,s]=C.split(":").map(Number),i=y+z;for(let a=e;a<=l;a++)for(let o=0;o<60;o+=i){if(a===e&&o<t||a===l&&o+y>s)continue;let i=a.toString().padStart(2,"0"),n=o.toString().padStart(2,"0");r.push("".concat(i,":").concat(n))}}let c={date:u(b),onlineSlots:null!=(t=null!=(e=null==$?void 0:$.onlineSlots)?e:null==$?void 0:$.slots)?t:[],inStudioSlots:null!=(l=null==$?void 0:$.inStudioSlots)?l:[],freeConsultationSlots:null!=(s=null==$?void 0:$.freeConsultationSlots)?s:[],studioSlots:null!=(i=null==$?void 0:$.studioSlots)?i:{}};if("normal"===L)if("online"===R)c.onlineSlots=o;else{if(!I)return void n.oR.error("Seleziona una sede prima di generare gli slot in studio");c.studioSlots={...null!=(a=null==$?void 0:$.studioSlots)?a:{},[I]:o}}else c.freeConsultationSlots=r;A(c)},className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:["⚡ ","normal"===L?"Genera slot normali":"Genera slot promozionali"]}),(0,s.jsx)(o.$,{onClick:Y,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:"\uD83D\uDCBE Salva"})]})]}),$&&(0,s.jsx)("div",{className:"mt-6 bg-card border border-border rounded-lg p-6 shadow-sm",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-xl font-semibold text-black",children:["\uD83D\uDCC5 Disponibilit\xe0 per ",b.toLocaleDateString("it-IT",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),(0,s.jsx)("p",{className:"text-sm text-black/70 mt-1",children:"promotional"===L?"\uD83C\uDFAF ".concat((null==(e=$.freeConsultationSlots)?void 0:e.length)||0," slot consultazioni gratuite configurati"):"online"===R?"\uD83D\uDCCB ".concat((null!=(m=null!=(d=$.onlineSlots)?d:$.slots)?m:[]).length," slot normali configurati (Online)"):"\uD83D\uDCCB ".concat(null!=(x=null==(l=$.studioSlots)||null==(t=l[I])?void 0:t.length)?x:0," slot normali configurati (Sede: ").concat(I||"—",")")})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>q(!T),className:"flex items-center gap-2",children:T?"❌ Chiudi":"➕ Aggiungi Orario"}),(0,s.jsx)(o.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{if($){if("promotional"===L)A({...$,freeConsultationSlots:[]});else if("online"===R)A({...$,onlineSlots:[]});else{var e;if(!I)return void n.oR.error("Seleziona una sede");A({...$,studioSlots:{...null!=(e=$.studioSlots)?e:{},[I]:[]}})}n.oR.success("Tutti gli orari sono stati rimossi")}},className:"flex items-center gap-2 text-red-600 hover:text-red-700",children:"\uD83D\uDDD1️ Svuota tutti"})]})]}),T&&(0,s.jsxs)("div",{className:"p-4 border border-border rounded-lg space-y-4 bg-muted/20",children:[(0,s.jsxs)("div",{className:"flex gap-3 items-end",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(c,{label:"\uD83D\uDD50 Orario specifico",value:B,onChange:M})}),(0,s.jsx)(o.$,{type:"button",size:"md",onClick:()=>{B&&((e=>{var t,l,s,i,a,o;if(!$)return;let r="promotional"===L?$.freeConsultationSlots||[]:"online"===R?null!=(s=null!=(l=$.onlineSlots)?l:$.slots)?s:[]:I?null!=(i=null==(t=$.studioSlots)?void 0:t[I])?i:[]:null!=(a=$.inStudioSlots)?a:[];if(r.includes(e))n.oR.error("L'orario ".concat(e," \xe8 gi\xe0 presente"));else{let t=[...r,e].sort();if("promotional"===L)A({...$,freeConsultationSlots:t});else if("online"===R)A({...$,onlineSlots:t});else{if(!I)return n.oR.error("Seleziona una sede");A({...$,studioSlots:{...null!=(o=$.studioSlots)?o:{},[I]:t}})}n.oR.success("Orario ".concat(e," aggiunto"))}})(B),M(""))},className:"flex items-center gap-2",children:"➕ Aggiungi"})]}),(0,s.jsx)("p",{className:"text-sm text-black/70",children:"promotional"===L?"\uD83C\uDFAF Aggiungi slot dedicati ai 10 minuti consultivi gratuiti":"\uD83D\uDCCB Aggiungi slot per consulenze normali"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium text-sm text-black flex items-center gap-2",children:"promotional"===L?"\uD83C\uDFAF Slot Consultazioni Gratuite Configurati:":"\uD83D\uDCCB Slot Normali Configurati:"}),(()=>{var e,t,l,i,a;let o="promotional"===L?$.freeConsultationSlots||[]:"online"===R?null!=(l=null!=(t=$.onlineSlots)?t:$.slots)?l:[]:I?null!=(i=null==(e=$.studioSlots)?void 0:e[I])?i:[]:null!=(a=$.inStudioSlots)?a:[];return o.length>0?(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:o.map(e=>(0,s.jsxs)("div",{className:"group relative p-3 border border-border rounded-lg bg-background hover:border-primary/50 transition-all duration-200",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-black",children:(()=>{let t=/^\d{4}-\d{2}-\d{2}T(\d{2}):(\d{2})/.exec(e);return t?"".concat(t[1],":").concat(t[2]):e})()}),(0,s.jsx)("button",{type:"button",onClick:()=>(e=>{var t,l,s,i,a,o;if(!$)return;let r=("promotional"===L?$.freeConsultationSlots||[]:"online"===R?null!=(s=null!=(l=$.onlineSlots)?l:$.slots)?s:[]:I?null!=(i=null==(t=$.studioSlots)?void 0:t[I])?i:[]:null!=(a=$.inStudioSlots)?a:[]).filter(t=>t!==e);if("promotional"===L)A({...$,freeConsultationSlots:r});else if("online"===R)A({...$,onlineSlots:r});else{if(!I)return void n.oR.error("Seleziona una sede");A({...$,studioSlots:{...null!=(o=$.studioSlots)?o:{},[I]:r}})}n.oR.success("Orario ".concat(e," rimosso"))})(e),className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-red-600",title:"Rimuovi orario",children:"\xd7"})]},e))}):(0,s.jsxs)("div",{className:"text-center py-8 text-black/70",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCC5"}),(0,s.jsx)("p",{className:"text-sm",children:"promotional"===L?"Nessuno slot dedicato configurato per questa data":"Nessuno slot disponibile per questa data"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:"Usa i controlli sopra per generare slot o aggiungi orari manualmente"})]})})()]})]})})]})}function u(e){let t=e=>String(e).padStart(2,"0");return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()))}l(9157)},3998:(e,t,l)=>{"use strict";l.d(t,{$:()=>n});var s=l(5155),i=l(2115),a=l(5889),o=l(2821);let n=(0,i.forwardRef)((e,t)=>{let{className:l,variant:i="primary",size:n="md",fullWidth:r,...c}=e;return(0,s.jsx)("button",{ref:t,className:(0,a.QP)((0,o.$)("btn",{primary:"btn-primary",secondary:"btn-outline",ghost:"hover:bg-[color:var(--muted-bg)]",outline:"btn-outline"}[i],{sm:"px-3 py-1 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[n],r&&"w-full"),l),...c})});n.displayName="Button"},7001:(e,t,l)=>{Promise.resolve().then(l.bind(l,2063))}},e=>{e.O(0,[3038,9135,3965,5579,2545,8744,9719,2473,3237,9018,8441,1255,7358],()=>e(e.s=7001)),_N_E=e.O()}]);