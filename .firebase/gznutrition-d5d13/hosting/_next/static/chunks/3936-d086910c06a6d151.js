"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3936],{3936:(e,o,t)=>{t.d(o,{BookingForm:()=>S});var a=t(5155),r=t(2115),n=t(2544),l=t(6942),i=t(2377),s=t(3998),c=t(5142),d=t(9018),m=t(8674),u=t(8901),g=t(7205),p=t(5513),x=t(9228),b=t(2473),f=t(63),h=t(2381),v=t(3366),F=t(569),y=t(4986),N=t(2663),j=t(1141),k=t(9060);let P=i.Ik({name:i.Yj().min(2,"Nome troppo corto"),email:i.Yj().email("Email non valida"),phone:i.Yj().min(7,"Telefono obbligatorio").regex(/^[+0-9\s-]+$/,"Formato non valido"),date:i.Yj().min(1,"Seleziona una data"),slot:i.Yj().min(1,"Seleziona un orario disponibile"),location:i.k5(["online","studio"]).optional(),packageId:i.Yj().optional(),notes:i.Yj().optional(),gdprConsent:i.zM().refine(e=>!0===e,{message:"Devi accettare il trattamento dei dati personali per continuare"})});function C(e){let{availableDates:o,selectedDate:t,onDateSelect:n,showPromotionalBanner:l}=e,[i,s]=(0,r.useState)(new Date),[c,d]=(0,r.useState)(!1),h=(0,m.w)(i),v=(0,u.p)(i),y=(0,g.k)({start:h,end:v}),N=e=>{let t=(0,b.GP)(e,"yyyy-MM-dd");return o.includes(t)};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-full p-3 border border-border rounded-lg bg-background text-foreground cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>d(!c),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:t?"text-foreground":"text-foreground/60",children:t?(0,b.GP)(new Date(t),"EEEE d MMMM yyyy",{locale:F.it}):"Seleziona una data"}),(0,a.jsx)("span",{className:"text-gray-600",children:"\uD83D\uDCC5"})]})}),c&&(0,a.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-background border border-border rounded-lg shadow-lg z-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("button",{onClick:()=>s((0,x.a)(i,1)),className:"p-2 hover:bg-muted rounded-lg transition-colors",children:"←"}),(0,a.jsx)("h3",{className:"font-semibold text-foreground",children:(0,b.GP)(i,"MMMM yyyy",{locale:F.it})}),(0,a.jsx)("button",{onClick:()=>s((0,p.P)(i,1)),className:"p-2 hover:bg-muted rounded-lg transition-colors",children:"→"})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Lun","Mar","Mer","Gio","Ven","Sab","Dom"].map(e=>(0,a.jsx)("div",{className:"w-10 h-10 flex items-center justify-center text-xs font-medium text-foreground",children:e},e))}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1",children:y.map((e,o)=>(0,a.jsx)("div",{className:(e=>{let o="w-10 h-10 flex items-center justify-center text-sm rounded-full cursor-pointer transition-all duration-200";return((0,f.c)(e)&&(o+=" ring-2 ring-primary/50"),t===(0,b.GP)(e,"yyyy-MM-dd"))?o+=" bg-primary text-primary-foreground font-semibold":N(e)?o+=" bg-emerald-100 text-emerald-800 hover:bg-emerald-200 font-medium border border-emerald-200":o+=" bg-gray-100 text-gray-400 cursor-not-allowed",o})(e),onClick:()=>(e=>{let o=(0,b.GP)(e,"yyyy-MM-dd");N(e)&&(n(o),d(!1))})(e),children:(0,b.GP)(e,"d")},o))}),(0,a.jsx)("div",{className:"mt-4 pt-3 border-t border-border",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full border border-green-700"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Disponibile"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-gray-100 rounded-full"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Non disponibile"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-primary rounded-full"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Selezionato"})]})]})}),l&&(0,a.jsx)("div",{className:"mt-3 p-2 bg-green-50 border border-green-200 rounded text-center",children:(0,a.jsx)("p",{className:"text-xs text-green-700",children:"\uD83C\uDFAF Solo date con slot promozionali disponibili"})})]}),c&&(0,a.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)})]})}function S(e){var o;let{adminMode:i=!1,requirePackage:m=!1,hidePackageSelect:u=!1}=e,[g,p]=(0,r.useState)(!1),[x,f]=(0,r.useState)(""),[F,S]=(0,r.useState)(""),[E,w]=(0,r.useState)([]),[z,I]=(0,r.useState)([]),[T,B]=(0,r.useState)(null),[D,A]=(0,r.useState)([]),[R,O]=(0,r.useState)(null),[M,L]=(0,r.useState)(""),[G,U]=(0,r.useState)([]),[V,_]=(0,r.useState)(null),[H,J]=(0,r.useState)(null),Y=(0,r.useRef)([]),W=(0,r.useRef)([]),Z=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await (0,d.getSiteContent)();if(e){var o;_(t);let e=null!=(o=null==t?void 0:t.contactAddresses)?o:[];U(e),1===e.length&&L(e[0].name)}}catch(e){}})(),()=>{e=!1}},[]);let[$,q]=(0,r.useState)((0,y.J5)());(0,r.useEffect)(()=>{let e=e=>{console.log("\uD83D\uDD04 DirectState cambiato:",e.detail),q(e.detail)};return window.addEventListener("directStateChange",e),()=>{window.removeEventListener("directStateChange",e)}},[]);let K=$.isFreeConsultation||(null==T?void 0:T.isPromotional)===!0;console.log("\uD83C\uDFAF BookingForm - isFreeConsultation:",K),console.log("\uD83C\uDFAF BookingForm - directState completo:",$),console.log("\uD83C\uDFAF BookingForm - selectedPackage promozionale:",null==T?void 0:T.isPromotional),console.log("\uD83C\uDFAF BookingForm - fonte consulenza gratuita:",$.isFreeConsultation?"popup":(null==T?void 0:T.isPromotional)?"dropdown pacchetto promozionale":"nessuna"),console.log("\uD83D\uDCC5 BookingForm - selectedDate:",F);let Q=P.refine(e=>!e.date||!e.slot||Y.current.includes(e.slot),{message:"L'orario selezionato non \xe8 pi\xf9 disponibile",path:["slot"]}),{register:X,handleSubmit:ee,formState:{errors:eo},setValue:et,watch:ea}=(0,n.mN)({resolver:(0,l.u)(Q),defaultValues:{name:"",email:"",phone:"",date:"",slot:"",notes:"",packageId:$.selectedPackageId||"",gdprConsent:!1}});(0,r.useEffect)(()=>{console.log("BookingForm: NUOVO SISTEMA - Inizializzazione"),(async()=>{try{console.log("BookingForm: Caricamento pacchetti...");let e=await (0,d.getPackages)();console.log("BookingForm: Pacchetti caricati:",e),console.log("\uD83C\uDFAF PACCHETTI PROMOZIONALI TROVATI:",e.filter(e=>e.isPromotional)),console.log("\uD83C\uDFAF TUTTI I PACCHETTI CON FLAG PROMOZIONALE:",e.map(e=>({title:e.title,isPromotional:e.isPromotional}))),console.log("\uD83C\uDFAF TUTTI GLI ID DEI PACCHETTI:",e.map(e=>e.id)),console.log("\uD83C\uDFAF PACCHETTO FREE-CONSULTATION ESISTE?",e.some(e=>"free-consultation"===e.id));let o=e||[];A(o),W.current=o;let t=(0,y.J5)();if(console.log("BookingForm: Stato diretto attuale:",t),t.selectedPackageId&&o.length>0){console.log("BookingForm: Cercando pacchetto con ID:",t.selectedPackageId),console.log("BookingForm: Pacchetti disponibili:",o.map(e=>({id:e.id,title:e.title,isPromotional:e.isPromotional})));let e=o.find(e=>e.id===t.selectedPackageId);console.log("BookingForm: Pacchetto trovato:",e),e?(B(e),et("packageId",e.id||""),console.log("BookingForm: SUCCESSO - Form precompilato con:",e.title)):console.error("BookingForm: ERRORE - Pacchetto non trovato con ID:",t.selectedPackageId)}}catch(e){console.error("BookingForm: Errore caricamento pacchetti:",e)}})();let e=e=>{if(console.log("BookingForm: Cambio stato diretto:",e.detail),q(e.detail),e.detail.selectedPackageId&&W.current.length>0){console.log("BookingForm: Evento directStateChange - Cercando pacchetto con ID:",e.detail.selectedPackageId),console.log("BookingForm: Pacchetti disponibili per evento:",W.current.map(e=>({id:e.id,title:e.title,isPromotional:e.isPromotional})));let o=W.current.find(o=>o.id===e.detail.selectedPackageId);console.log("BookingForm: Pacchetto trovato per evento:",o),o?(B(o),et("packageId",o.id||""),console.log("BookingForm: Form aggiornato via evento:",o.title)):console.error("BookingForm: ERRORE - Pacchetto non trovato per evento con ID:",e.detail.selectedPackageId)}};return window.addEventListener("directStateChange",e),()=>{window.removeEventListener("directStateChange",e)}},[et]),(0,r.useEffect)(()=>{Y.current=E},[E]),(0,r.useEffect)(()=>{(async()=>{let e=K||(null==T?void 0:T.isPromotional)===!0?60:14;console.log("\uD83D\uDCC5 Generando ".concat(e," date per ").concat(K?"consulenza gratuita":"consulenza normale"));let o=Array.from({length:e},(e,o)=>{let t=(0,h.f)((0,v.o)(new Date),o);return(0,b.GP)(t,"yyyy-MM-dd")}).map(async e=>{try{let r=await (0,d.getAvailabilityByDate)(e);if(r){let n=K||(null==T?void 0:T.isPromotional)===!0;if(console.log("\uD83D\uDCC5 Date ".concat(e," - shouldUsePromotionalSlots:"),n,"isFreeConsultation:",K,"isPromotional:",null==T?void 0:T.isPromotional),n)if(r.freeConsultationSlots&&r.freeConsultationSlots.length>0)return console.log("✅ Date ".concat(e," - Found promotional slots:"),r.freeConsultationSlots),e;else console.log("❌ Date ".concat(e," - No promotional slots available"));else{var o,t,a;let n=null!=(o=r.onlineSlots)?o:[],l=r.studioSlots&&M?null!=(t=r.studioSlots[M])?t:[]:null!=(a=r.inStudioSlots)?a:[],i=null===R?[...n,...l]:"online"===R?n:l;if(i&&i.length>0)return e}}return null}catch(o){return console.error("Errore nel controllo disponibilit\xe0 per ".concat(e,":"),o),null}});I((await Promise.all(o)).filter(e=>null!==e))})()},[T,K,R,M]),(0,r.useEffect)(()=>{F&&(async()=>{try{let r=await (0,d.getAvailabilityByDate)(F);if(r){let n=K||(null==T?void 0:T.isPromotional)===!0;if(console.log("\uD83D\uDD0D DEBUG SLOT:",{isFreeConsultation:K,selectedPackage:null==T?void 0:T.title,isPromotional:null==T?void 0:T.isPromotional,shouldUsePromotionalSlots:n,directState:$,selectionSource:K?"popup consulenze gratuite":"dropdown form"}),n)console.log("\uD83C\uDFAF CONSULENZA GRATUITA/PROMOZIONALE - Caricando slot promozionali:",r.freeConsultationSlots),w(r.freeConsultationSlots||[]);else{var e,o,t,a;console.log("\uD83D\uDCCB CONSULENZA NORMALE - Caricando slot normali");let n=null!=(e=r.onlineSlots)?e:[],l=r.studioSlots&&M?null!=(o=r.studioSlots[M])?o:[]:null!=(t=r.inStudioSlots)?t:[],i=null!=(a=r.slots)?a:[],s=null===R?n.length||l.length?[...n,...l]:i:"online"===R?n:l;console.log("\uD83D\uDCCB Pool slot normali selezionato:",s),w(s)}}}catch(e){console.error("Errore nel caricamento disponibilit\xe0:",e),w([])}})()},[F,T,K,R,M]);let er=async e=>{if(!g){if(m&&!T&&!i)return void N.oR.error("Seleziona un pacchetto per continuare",{duration:3e3,position:"top-center",style:{background:ei.warning,color:"white",fontWeight:"600",borderRadius:"12px",padding:"16px 24px",fontSize:"16px",boxShadow:"0 10px 25px ".concat(ei.warning,"30")}});if(!i&&(null==V?void 0:V.recaptchaEnabled)&&!H)return void N.oR.error("Completa la verifica CAPTCHA per continuare",{duration:3e3,position:"top-center",style:{background:ei.warning,color:"white",fontWeight:"600",borderRadius:"12px",padding:"16px 24px",fontSize:"16px",boxShadow:"0 10px 25px ".concat(ei.warning,"30")}});p(!0),f("Preparando prenotazione...");try{let o={...e,isFreeConsultation:K,status:"pending"};f("Verificando disponibilit\xe0..."),console.log("\uD83D\uDE80 Tentativo prenotazione consulenza gratuita:",{isFreeConsultation:K,selectedPackage:T});try{f("Inviando prenotazione...");let{createBooking:e,getDataMode:a}=await Promise.resolve().then(t.bind(t,9018)),r=a();console.log("\uD83D\uDD0D MODALIT\xc0 DATA ATTIVA:",r),console.log("\uD83C\uDF10 NODE_ENV:","production"),console.log("\uD83D\uDD25 Firebase Config Present:",!0);let n={name:o.name,email:o.email,phone:o.phone||void 0,packageId:null==T?void 0:T.id,date:o.date,slot:o.slot,location:K||(null==T?void 0:T.isPromotional)===!0?"online":R,studioLocation:"studio"===R&&M||void 0,status:i?"confirmed":"pending",notes:o.notes,isFreeConsultation:K};console.log("\uD83D\uDCE4 Payload prenotazione:",n),console.log("\uD83D\uDD11 CAPTCHA token:",H?"presente":"assente"),console.log("\uD83C\uDFAF VERIFICA FLAG: isFreeConsultation nel payload =",n.isFreeConsultation),console.log("\uD83C\uDFAF VERIFICA FLAG: variabile locale isFreeConsultation =",K);let l=await e(n,H||void 0);if(f("Completato!"),console.log("✅ Prenotazione creata con successo! ID:",l),console.log("\uD83D\uDD0D Modalit\xe0 data utilizzata per questa prenotazione:","Firebase"),!l)throw Error("Prenotazione fallita - nessun ID ricevuto")}catch(a){console.error("❌ Errore createBooking principale:",a),console.error("❌ Dettaglio errore:",a.message);let e=(await Promise.resolve().then(t.bind(t,9018))).getDataMode();if("local"===e){if(f("Tentativo sistema di backup locale..."),console.log("\uD83D\uDD04 Usando fallback locale in modalit\xe0 dev..."),!(await fetch("/api/localdb/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw console.error("❌ Fallback locale fallito anche!"),Error("Prenotazione fallita completamente");f("Backup locale completato!"),console.log("✅ Fallback locale riuscito")}else throw Error("Prenotazione fallita in modalit\xe0 ".concat(e,": ").concat(a.message))}N.oR.success(K?"Consulenza gratuita prenotata con successo!":"Prenotazione inviata con successo!",{duration:4e3,position:"top-center",style:{background:"linear-gradient(135deg, ".concat(ei.success," 0%, ").concat(ei.primary," 100%)"),color:"white",fontWeight:"600",borderRadius:"16px",padding:"20px 28px",fontSize:"16px",boxShadow:"0 20px 40px rgba(".concat(ei.primaryRgb,", 0.4)"),border:"1px solid rgba(255, 255, 255, 0.2)"},icon:"✓",iconTheme:{primary:"#ffffff",secondary:ei.primary}}),et("name",""),et("email",""),et("phone",""),et("date",""),et("slot",""),et("notes",""),et("gdprConsent",!1),S(""),w([]),B(null),et("packageId",""),J(null),Z.current&&Z.current.reset()}catch(e){console.error("Errore:",e),N.oR.error("Errore nell'invio della prenotazione. Riprova.",{duration:4e3,position:"top-center",style:{background:ei.error,color:"white",fontWeight:"600",borderRadius:"12px",padding:"16px 24px",fontSize:"16px",boxShadow:"0 10px 25px ".concat(ei.error,"30")}})}finally{p(!1),f(""),Z.current&&Z.current.reset()}}},en=null==T?void 0:T.isPromotional;console.log("\uD83C\uDFAF SHOW PROMOTIONAL BANNER:",{selectedPackage:null==T?void 0:T.title,isPromotional:null==T?void 0:T.isPromotional,showPromotionalBanner:en,isFreeConsultation:K});let el=e=>{let o=e.replace("#",""),t=parseInt(3===o.length?o.split("").map(e=>e+e).join(""):o,16);return"".concat(t>>16&255,", ").concat(t>>8&255,", ").concat(255&t)},ei=(()=>{let e=(null==V?void 0:V.colorPalette)||"gz-default",o=(0,k.AT)(e);return{primary:o.primary,accent:o.accent,success:o.primary,error:"#EF4444",warning:"#F59E0B",primaryRgb:el(o.primary),accentRgb:el(o.accent)}})();return console.log("\uD83C\uDFA8 PALETTE DINAMICA:",{paletteId:(null==V?void 0:V.colorPalette)||"gz-default",colors:ei}),console.log("BookingForm: RENDER - selectedPackage:",T),console.log("BookingForm: RENDER - packages:",D),console.log("BookingForm: RENDER - packages.length:",D.length),(0,a.jsxs)("div",{className:"section-surface p-6 sm:p-8 space-y-6",children:[T&&(0,a.jsx)("div",{className:"rounded-xl p-4 shadow-md ".concat(en?"bg-green-50 border border-green-200":"border border-foreground/20 bg-background/70 backdrop-blur-sm"),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-9 h-9 rounded-full flex items-center justify-center ".concat(en?"bg-green-100":"bg-primary/10"),children:(0,a.jsx)("span",{className:"text-lg",children:en?"\uD83C\uDFAF":"\uD83D\uDCE6"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold ".concat(en?"text-green-800":"text-foreground"),children:T.title}),(0,a.jsx)("p",{className:"text-sm ".concat(en?"text-green-700":"text-foreground"),children:function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;if(e.length<=o)return e;let t=e.substring(0,o),a=t.lastIndexOf(" ");return a>.8*o?t.substring(0,a)+"...":t+"..."}(T.description)}),!en&&(0,a.jsxs)("div",{className:"mt-2",children:[T.hasDiscount&&T.basePrice&&T.discountedPrice?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-lg font-bold text-primary",children:["€ ",T.discountedPrice]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 line-through",children:["€ ",T.basePrice]}),T.discountPercentage&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs font-bold rounded-full",children:["-",T.discountPercentage,"%"]})]}):(0,a.jsxs)("p",{className:"text-sm font-medium text-primary",children:["€ ",T.price]}),T.paymentText&&(0,a.jsx)("p",{className:"text-xs text-foreground mt-1",children:T.paymentText})]})]})]})}),(0,a.jsxs)("form",{onSubmit:ee(er),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2 text-foreground",children:"Pacchetto"}),(0,a.jsxs)("select",{value:(null==T?void 0:T.id)||"",onChange:e=>{var o;let t=e.target.value;o=D.find(e=>e.id===t)||null,console.log("\uD83D\uDD04 CAMBIO PACCHETTO:",{old:null==T?void 0:T.title,new:null==o?void 0:o.title,isPromotional:null==o?void 0:o.isPromotional,shouldUsePromotionalSlots:(null==o?void 0:o.isPromotional)===!0}),B(o),et("packageId",(null==o?void 0:o.id)||""),et("date",""),et("slot",""),S(""),w([]),I([])},className:"w-full rounded-lg border border-foreground/10 bg-background/70 backdrop-blur-sm px-3.5 py-2.5 text-sm text-foreground focus:outline-none focus:ring-4 focus:ring-[rgba(var(--primary-rgb),0.15)]",children:[(0,a.jsx)("option",{value:"",children:"Seleziona un pacchetto"}),D.map(e=>{let o="";return o=e.isPromotional?"(Gratuito)":e.hasDiscount&&e.basePrice&&e.discountedPrice?"- €".concat(e.discountedPrice," (scontato da €").concat(e.basePrice,")"):"- €".concat(e.price),(0,a.jsxs)("option",{value:e.id||"",children:[e.title," ",o]},e.id)})]}),(0,a.jsx)("p",{className:"text-xs text-black mt-1",children:"Puoi cambiare pacchetto in qualsiasi momento"})]}),(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)(c.p,{label:"Nome completo *",...X("name"),placeholder:"Il tuo nome"}),eo.name&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:eo.name.message})]}),(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)(c.p,{label:"Email *",type:"email",...X("email"),placeholder:"la-tua-email@esempio.com"}),eo.email&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:eo.email.message})]}),(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)(c.p,{label:"Telefono *",...X("phone"),placeholder:"+39 123 456 7890"}),eo.phone&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:eo.phone.message})]}),!(en||K)&&(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"Sede appuntamento"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",role:"group","aria-label":"Sede appuntamento",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>O("online"),"aria-pressed":"online"===R,className:"relative flex items-center gap-3 p-3 rounded-xl border-2 transition-all focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-[rgba(var(--primary-rgb),0.15)] ".concat("online"===R?"border-primary bg-primary/5 shadow-[0_0_0_3px_rgba(11,94,11,0.10)]":"border-border hover:border-primary/40"),children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83C\uDF10"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"text-sm font-semibold ".concat("online"===R?"text-primary":"text-black"),children:"Online"}),(0,a.jsx)("div",{className:"text-[12px] text-foreground/60",children:"Videochiamata"})]})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>O("studio"),"aria-pressed":"studio"===R,className:"relative flex items-center gap-3 p-3 rounded-xl border-2 transition-all focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-[rgba(var(--primary-rgb),0.15)] ".concat("studio"===R?"border-primary bg-primary/5 shadow-[0_0_0_3px_rgba(11,94,11,0.10)]":"border-border hover:border-primary/40"),children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83C\uDFE2"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"text-sm font-semibold ".concat("studio"===R?"text-primary":"text-black"),children:"In studio"}),(0,a.jsx)("div",{className:"text-[12px] text-foreground/60",children:"Presso studio"})]})]})]}),(0,a.jsx)("p",{className:"text-xs text-black mt-2",children:"Per consultazioni gratuite la sede \xe8 sempre Online."})]}),"studio"===R&&(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"Seleziona sede"}),(0,a.jsxs)("select",{value:M,onChange:e=>{L(e.target.value),et("slot","")},className:"w-full p-3 border border-border rounded-lg bg-background text-black",children:[(0,a.jsx)("option",{value:"",children:"-- Seleziona sede --"}),G.map((e,o)=>(0,a.jsx)("option",{value:e.name,children:e.name},o))]}),""===M&&(0,a.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Seleziona una sede per visualizzare gli slot disponibili."})]}),i&&m&&!u&&(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2 text-foreground",children:"Seleziona pacchetto"}),(0,a.jsxs)("select",{value:ea("packageId"),onChange:e=>{let o=e.target.value;et("packageId",o),B(D.find(e=>e.id===o)||null)},className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm text-foreground",children:[(0,a.jsx)("option",{value:"",children:"Nessun pacchetto"}),D.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-2 text-black",children:["Data * ",en&&(0,a.jsx)("span",{className:"text-green-600",children:"(Solo date con disponibilit\xe0)"})]}),(0,a.jsx)(C,{availableDates:z,selectedDate:F,onDateSelect:e=>{S(e),et("date",e),et("slot","")},showPromotionalBanner:en||!1}),eo.date&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:eo.date.message}),0===z.length&&(0,a.jsx)("p",{className:"text-black text-sm mt-1",children:en?"Nessuna data disponibile per consultazioni gratuite":"Nessuna data disponibile per consulenze"})]}),F&&E.length>0&&(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-2 text-black",children:["Orario disponibile * ",en&&(0,a.jsx)("span",{className:"text-green-600",children:"(Slot promozionali)"})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:E.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>et("slot",e),className:"p-3 border rounded-lg text-sm transition-colors ".concat(ea("slot")===e?"border-primary bg-[color:var(--secondary-bg)] text-[color:var(--secondary-fg)]":"border-border hover:border-primary/50"),children:(()=>{if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}/.test(e))try{let o=new Date(e),t=String(o.getHours()).padStart(2,"0"),a=String(o.getMinutes()).padStart(2,"0");return"".concat(t,":").concat(a)}catch(e){}return e})()},e))}),eo.slot&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:eo.slot.message})]}),(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"Parlami di te"}),(0,a.jsx)("textarea",{...X("notes"),placeholder:"Raccontaci i tuoi obiettivi, esperienze precedenti, preferenze alimentari, eventuali limitazioni o qualsiasi altra informazione che ritieni importante per la tua consulenza...",className:"w-full rounded-lg border border-foreground/10 bg-background/70 backdrop-blur-sm px-3.5 py-2.5 text-sm text-black min-h-[120px] resize-y focus:outline-none focus:ring-4 focus:ring-[rgba(var(--primary-rgb),0.15)]",rows:5})]}),!i&&(0,a.jsx)("div",{className:"form-surface p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("input",{type:"checkbox",id:"gdprConsent",...X("gdprConsent"),className:"mt-1 w-4 h-4 text-primary bg-background border-foreground/20 rounded focus:ring-primary focus:ring-2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("label",{htmlFor:"gdprConsent",className:"text-sm text-black cursor-pointer",children:[(0,a.jsx)("span",{className:"font-medium",children:"Accetto il trattamento dei dati personali *"}),(0,a.jsx)("p",{className:"text-xs text-foreground/70 mt-1",children:(null==V||null==(o=V.legalInfo)?void 0:o.gdprConsentText)||"Acconsento al trattamento dei miei dati personali per la gestione della prenotazione e per ricevere comunicazioni relative al servizio, ai sensi del GDPR (Regolamento UE 2016/679). I dati saranno utilizzati esclusivamente per le finalit\xe0 indicate e non saranno comunicati a terzi."}),(0,a.jsx)("a",{href:"/privacy",className:"text-primary hover:underline text-xs mt-1 inline-block",children:"Leggi la Privacy Policy"})]}),eo.gdprConsent&&(0,a.jsx)("p",{className:"text-destructive text-sm mt-1",children:eo.gdprConsent.message})]})]})}),!i&&(null==V?void 0:V.recaptchaEnabled)&&(null==V?void 0:V.recaptchaSiteKey)&&(0,a.jsxs)("div",{className:"form-surface p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"Verifica di sicurezza *"}),(0,a.jsx)(j.A,{ref:Z,sitekey:V.recaptchaSiteKey,onChange:e=>J(e),onExpired:()=>J(null),onError:()=>J(null)})]}),(0,a.jsxs)(s.$,{type:"submit",disabled:g||!i&&(null==V?void 0:V.recaptchaEnabled)&&!H,className:"w-full relative transition-all duration-300",style:{background:g?"linear-gradient(to right, rgba(".concat(ei.primaryRgb,", 0.8), rgba(").concat(ei.primaryRgb,", 0.9))"):"linear-gradient(to right, ".concat(ei.primary,", rgba(").concat(ei.primaryRgb,", 0.9))"),transform:g?"scale(0.98)":"scale(1)",boxShadow:g?"0 10px 20px rgba(".concat(ei.primaryRgb,", 0.3)"):"0 4px 12px rgba(".concat(ei.primaryRgb,", 0.2)")},onMouseEnter:e=>{g||(e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 15px 30px rgba(".concat(ei.primaryRgb,", 0.4)"))},onMouseLeave:e=>{g||(e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 12px rgba(".concat(ei.primaryRgb,", 0.2)"))},onMouseDown:e=>{g||(e.currentTarget.style.transform="scale(0.95)")},onMouseUp:e=>{g||(e.currentTarget.style.transform="scale(1.05)")},children:[g&&(0,a.jsx)("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2",children:(0,a.jsx)("div",{className:"w-5 h-5 border-2 rounded-full animate-spin",style:{borderColor:"rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRightColor:"rgba(255, 255, 255, 0.6)"}})}),(0,a.jsx)("span",{className:"font-semibold transition-all duration-300 ".concat(g?"ml-8":""),children:g?"Invio in corso...":T?en?"Prenota Consultazione Gratuita":"Prenota Consulenza":"Invia richiesta"})]}),T&&en&&(0,a.jsx)("div",{className:"text-center text-sm text-black"})]}),g&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-black/40 to-black/60 backdrop-blur-md z-50 flex items-center justify-center animate-in fade-in duration-300",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-8 max-w-sm mx-4 text-center shadow-2xl border border-gray-100 animate-in slide-in-from-bottom-4 duration-500",children:[(0,a.jsx)("div",{className:"relative mb-6 flex justify-center",children:(0,a.jsxs)("div",{className:"relative w-16 h-16",children:[(0,a.jsx)("div",{className:"absolute inset-0 border-4 border-gray-200 rounded-full animate-spin",style:{borderTopColor:ei.primary,borderRightColor:ei.accent,borderBottomColor:"transparent",borderLeftColor:"transparent",animationDuration:"1s"}}),(0,a.jsx)("div",{className:"absolute inset-2 border-2 border-gray-100 rounded-full animate-spin",style:{borderTopColor:"transparent",borderRightColor:"transparent",borderBottomColor:ei.primary,borderLeftColor:ei.accent,animationDirection:"reverse",animationDuration:"1.5s"}}),(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 w-2 h-2 rounded-full",style:{backgroundColor:ei.primary,transform:"translate(-50%, -50%)"}})]})}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:K?"Consulenza Gratuita":"Nuova Prenotazione"})}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-4 animate-pulse",children:x||"Elaborazione in corso..."}),(0,a.jsx)("div",{className:"w-full bg-gray-100 rounded-full h-3 overflow-hidden shadow-inner",children:(0,a.jsx)("div",{className:"h-full rounded-full transition-all duration-700 ease-out shadow-sm relative overflow-hidden",style:{background:"linear-gradient(to right, ".concat(ei.primary,", rgba(").concat(ei.primaryRgb,", 0.8))"),width:x.includes("Preparando")?"25%":x.includes("Verificando")?"50%":x.includes("Inviando")?"75%":x.includes("Completato")||x.includes("Backup")?"100%":x.includes("Tentativo")?"90%":"15%"},children:(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse"})})}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500 font-medium",children:[x.includes("Preparando")?"25%":x.includes("Verificando")?"50%":x.includes("Inviando")?"75%":x.includes("Completato")||x.includes("Backup")?"100%":x.includes("Tentativo")?"90%":"15%"," completato"]})]})})]})}},3998:(e,o,t)=>{t.d(o,{$:()=>i});var a=t(5155),r=t(2115),n=t(5889),l=t(2821);let i=(0,r.forwardRef)((e,o)=>{let{className:t,variant:r="primary",size:i="md",fullWidth:s,...c}=e;return(0,a.jsx)("button",{ref:o,className:(0,n.QP)((0,l.$)("btn",{primary:"btn-primary",secondary:"btn-outline",ghost:"hover:bg-[color:var(--muted-bg)]",outline:"btn-outline"}[r],{sm:"px-3 py-1 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}[i],s&&"w-full"),t),...c})});i.displayName="Button"},4986:(e,o,t)=>{t.d(o,{J5:()=>r,v4:()=>n});let a="gznutrition_state",r=()=>{let e=new URLSearchParams(window.location.search).get("packageId");if(e){let o={selectedPackageId:e,isFreeConsultation:"free-consultation"===e};return localStorage.setItem(a,JSON.stringify(o)),o}try{let e=localStorage.getItem(a);if(e)return JSON.parse(e)}catch(e){console.error("DirectState: Errore lettura localStorage:",e)}return{selectedPackageId:null,isFreeConsultation:!1}},n=function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t={selectedPackageId:e,isFreeConsultation:o};if(console.log("DirectState: Impostazione stato:",t),localStorage.setItem(a,JSON.stringify(t)),e){let o=new URL(window.location.href);o.searchParams.set("packageId",e),window.history.replaceState({},"",o.toString())}window.dispatchEvent(new CustomEvent("directStateChange",{detail:t}))}},5142:(e,o,t)=>{t.d(o,{p:()=>l});var a=t(5155),r=t(2115),n=t(5889);let l=(0,r.forwardRef)((e,o)=>{let{className:t,label:r,error:l,id:i,...s}=e,c=i||s.name||"input";return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{htmlFor:c,className:"block text-sm font-medium mb-1 text-foreground",children:r}),(0,a.jsx)("input",{id:c,ref:o,className:(0,n.QP)("w-full rounded-lg border border-foreground/10 bg-background/70 backdrop-blur-sm px-3.5 py-2.5 text-sm text-foreground placeholder:text-foreground/50","focus:outline-none focus:ring-4 focus:ring-[rgba(var(--primary-rgb),0.15)] focus:ring-offset-0",l&&"border-accent",t),"aria-invalid":!!l,"aria-describedby":l?"".concat(c,"-error"):void 0,...s}),l&&(0,a.jsx)("p",{id:"".concat(c,"-error"),className:"mt-1 text-xs text-destructive",children:l})]})});l.displayName="Input"},9060:(e,o,t)=>{t.d(o,{AT:()=>r,LH:()=>a});let a={"gz-default":{name:"Default",description:"Palette originale verde professionale",primary:"#0B5E0B",accent:"#00D084",background:"#FFFFFF",foreground:"#0E0F12",border:"#E2E8F0",card:"#FFFFFF",muted:"#F1F5F9",navbarBg:"rgba(0,0,0,0.8)",navbarText:"#FFFFFF",secondaryBg:"#F8FAFC",secondaryText:"#475569"},"modern-blue":{name:"Modern Blue",description:"Blu moderno e professionale",primary:"#2563EB",accent:"#3B82F6",background:"#FFFFFF",foreground:"#1E293B",border:"#E2E8F0",card:"#FFFFFF",muted:"#F1F5F9",navbarBg:"rgba(30, 41, 59, 0.9)",navbarText:"#FFFFFF",secondaryBg:"#EFF6FF",secondaryText:"#1E40AF"},"elegant-dark":{name:"Elegant Dark",description:"Elegante scuro con accenti dorati",primary:"#D97706",accent:"#F59E0B",background:"#FFFFFF",foreground:"#1F2937",border:"#E5E7EB",card:"#FFFFFF",muted:"#F9FAFB",navbarBg:"rgba(17, 24, 39, 0.95)",navbarText:"#F9FAFB",secondaryBg:"#FEF3C7",secondaryText:"#92400E"},"nature-green":{name:"Nature Green",description:"Verde naturale e rilassante",primary:"#059669",accent:"#10B981",background:"#FFFFFF",foreground:"#1F2937",border:"#D1FAE5",card:"#FFFFFF",muted:"#F0FDF4",navbarBg:"rgba(6, 78, 59, 0.9)",navbarText:"#FFFFFF",secondaryBg:"#ECFDF5",secondaryText:"#047857"},"warm-orange":{name:"Warm Orange",description:"Arancione caldo ed energico",primary:"#EA580C",accent:"#FB923C",background:"#FFFFFF",foreground:"#1C1917",border:"#E7E5E4",card:"#FFFFFF",muted:"#FAFAF9",navbarBg:"rgba(124, 45, 18, 0.9)",navbarText:"#FFFFFF",secondaryBg:"#FED7AA",secondaryText:"#C2410C"},"professional-gray":{name:"Professional Gray",description:"Grigio professionale e neutro",primary:"#374151",accent:"#6B7280",background:"#FFFFFF",foreground:"#111827",border:"#E5E7EB",card:"#FFFFFF",muted:"#F9FAFB",navbarBg:"rgba(17, 24, 39, 0.9)",navbarText:"#F9FAFB",secondaryBg:"#F3F4F6",secondaryText:"#374151"}};function r(e){return a[e]||a["gz-default"]}}}]);